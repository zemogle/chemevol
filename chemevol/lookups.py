'''
Chemevol - Python package to read in a star formation history file,
input galaxy parameters and run a chemical evolution model to determine the evolution
of gas, metals and dust in galaxies.

Running this script will produce a results data file (filename.dat) with file name given by user

The code is based on Morgan & Edmunds 2003 (MNRAS, 343, 427)
and described in detail in De Vis et al 2017, 2021 (MNRAS, 471, 1743; ).

If you use this code, please do cite the above papers.

Copyright (C) 2015 Haley Gomez, Edward Gomez, Pieter De Vis and Simon Schofield, Cardiff University and LCOGT
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
'''

'''
This file lists the different tables required for lifetimes of stars of
different initial mass, and metal mass yields from
supernovae or from stellar winds at different metallicities.

It also includes a function to lookup nearest neighbour quantities
'''

from astropy.table import Table
import numpy as np
from bisect import bisect_left
from scipy import interpolate
import bisect
'''
- lifetime: the lifetime of stars of a given mass
            1st col: initial mass of star Msolar

            2nd col: lifetime in Gyrs, metallicity (Z) = 0.001
            3rd col: lifetime in Gyrs, Z = 0.02

            Values from Schaller et al 1992 (A & AS 96 269)
            this table allows us to call lifetime star but also
            mass of star that corresponds to age of system
'''
lifetime =  np.array([(0.8, 15.0, 26.0),
            (0.9, 9.5, 15.0),
            (1.0, 6.3, 10.0),
            (1.5, 1.8, 2.7),
            (2.0, 0.86, 1.1),
            (3.0, 0.29, 0.35),
            (4.0, 0.14, 0.16),
            (5.0, 0.088, 0.094),
            (7.0, 0.045, 0.043),
            (9.0, 0.029, 0.026),
            (12.0, 0.018, 0.016),
            (20.0, 0.0094, 0.0081),
            (40.0, 0.0049, 0.0043),
            (60.0, 0.0037, 0.0034),
            (85.0, 0.0031, 0.0028),
            (120.0, 0.0028, 0.0026)])

t_lifetime = Table(rows=lifetime, names=('mass','lifetime_low_metals','lifetime_high_metals'),meta={'name': 'Lifetime'})

'''
dust_mass_sn: dust mass returned by supernovae from Todini & Ferrara 2001 (MNRAS 325 276)
            1st column: initial mass of star
            2nd column: dust mass returned

            As TF01 only have SN masses for m_i > 12Msun
            (ie no 9Msun entry), we add dust for 8.5 + 9Msun progenitor
            by assuming no dust from 8.5 Msun, and similar dust/metals
            ratio for 12-20Msun for 9Msun
'''
dust_mass_sn = ((8.5,0),
                (9, 0.17),
                (12, 0.2),
                (15, 0.5),
                (20, 0.5),
                (22, 0.8),
                (25, 1.0),
                (30, 1.0),
                (35, 0.6),
                (40, 0.4))
'''
And expressed relative to the amount of metals expelled by the star:
This is the version that is used in the current version of the code so that the expelled amount of dust scales with the expelled amount of metals.
This leads to better consistnecy when using different metal yield tables. 
'''
dust_mass_sn_eff = ((8.5,0),
                (9, 0.7674),
                (12, 0.5),
                (15, 0.3508),
                (20, 0.176),
                (25, 0.2239),
                (30, 0.15),
                (35, 0.08),
                (40, 0.0451))


t_dustmass_sn = Table(rows=dust_mass_sn, names=('mass','dustmass'), meta={'name': 'Dust Mass SN'})


'''
The various metal yield tables are given below for both SN and AGB yields.
They are accessed through the find_yield and find_yield_tot functions which use the distionaries yield_dict and yield_dict_tot.
yield_dict refers to yield tables of fresh yields 
(i.e. the metal content present at the formation of the star needs to be added to the metal output).
yield_dict_tot has yield tables where the total output yields are given. 
All yield values need to be multiplied by their stellar mass to get the total yield.
We provide values for a range of different metallicities, which are also specified in yield_dict and yield_dict_tot.
In addition to total metal yields, the tables also include yields for N and O for most tables, and yields of O18, C and C13 for some.
Additional tables can be readily added by following the same formatting as for the others. The columns for eg LC18_R000_yields are:
#stellarmass, Z_0.0134,Z_0.00134,Z_0.000134,Z_0.0000134,O_0.0134,O_0.00134,O_0.000134,O_0.0000134,N_0.0134,N_0.00134,N_0.000134,N_0.0000134
The names to be used in the input files of the chemical evolution model are those in yield_dict and yield_dict_tot.
'''

VG97_yields = np.array([
(0.9,0.015559155555555555,0.007333318333333333,0.0030016337777777776,0.0014774667777777777,0.00042114222222222223,0.015475054444444443,0.007294633333333333,0.0029618336666666664,0.0014659447777777778,0.00042025222222222226,0.002100555423895518,0.0009983333279378712,0.0004029666626142959,0.00019556666943192893,5.595555288471385e-05),
(1.0,0.02521,0.012209998,0.0036320002,0.002574,0.00045915303,0.023909999,0.011580999,0.0035736002,0.0017836001,0.00045777005,0.0030685000117123126,0.0015149999669753014,0.0004869600002188236,0.0002302100000893697,6.260000105306972e-05),
(1.3,0.02124656923076923,0.011820923846153845,0.005894615692307692,0.004020769615384615,0.003620769230769231,0.02112376923076923,0.011492923846153845,0.004332615769230769,0.0021737693846153846,0.0007797692307692307,0.003020999941917566,0.0016423846212430641,0.0006003999752579973,0.0002853999919859835,7.425384476082399e-05),
(1.5,0.025313666666666665,0.015013333333333332,0.007966667333333333,0.00505,0.004123333333333334,0.025089465333333335,0.013304334000000001,0.005122667333333333,0.002687,0.0008773333333333333,0.0035978665951887766,0.00189133341734608,0.0006988533339550097,0.00035113999544829133,8.393333052750676e-05),
(1.7,0.027609823529411763,0.01578176411764706,0.008780588235294118,0.006625294117647059,0.004393529588235294,0.027259820588235294,0.013589763529411764,0.005519588235294118,0.002944294117647059,0.0009275294117647058,0.003970882300857235,0.001958823546219398,0.0007622823757568704,0.000377729406063171,8.954705843866309e-05),
(2.0,0.03,0.01794,0.01099,0.0086199995,0.0059499995,0.028287798,0.0140777,0.0058140005,0.003121,0.00106,0.004181349911689758,0.0022499999912455678,0.0009645050163753331,0.0005074300043582916,0.00012730000091483817),
(2.5,0.0339,0.0207999988,0.012564,0.009796000000000001,0.006293999999999999,0.030320200000000002,0.0151580988,0.006219000000000001,0.003372,0.00113300012,0.0046771998766064644,0.0026039999783039093,0.0011511319945544005,0.0006017680177748204,0.00013748000194318592),
(3.0,0.037156666666666664,0.022786666666666667,0.014273333333333332,0.01155,0.006076666666666667,0.031963066666666665,0.015865196666666668,0.006598333333333334,0.0036320003333333334,0.0011436666666666667,0.005137766521374384,0.002840666699409485,0.0012237466408958038,0.0006366599977239967,0.0001310666677262634),
(4.0,0.04059,0.02228999875,0.01164,0.00896,0.0073325,0.0327829975,0.015834,0.0062572,0.003366,0.0012035,0.005350099940896034,0.002943500018306076,0.004863225191265344,0.004660807538211346,0.0047740750829875465),
(5.0,0.042510002000000005,0.022599998,0.013038,0.010286,0.0085240006,0.03325,0.0160289988,0.0065140008,0.0034730002000000005,0.001216,0.005679620057702064,0.008432399702072144,0.006880554090213775,0.006588588133764267,0.0066262802011966705),
(7.0,0.04285,0.024682855714285714,0.01508142857142857,0.012240000000000001,0.010448571428571429,0.03314999857142857,0.015662856428571428,0.006099429000000001,0.003106000142857143,0.0009014714285714285,0.013724199446610044,0.010945999777317047,0.009280358256612506,0.008787480276857104,0.008748699579238892),
(8.0,0.0437899975,0.02553499875,0.01701,0.012975,0.0095512495,0.03325,0.01552499925,0.005818,0.00308400025,0.00086725,0.014533462809026242,0.01199875026345253,0.011575848516523837,0.009600259002149105,0.00799398742377758)])


KA10_yields = np.array([
(1.0,2.7411771740002123e-05,1.1926788227000848e-05,6.303829050000397e-06,0.00026707656225041017,-1.892e-06,-3.423e-06,-4.698e-06,1.1468239999999999e-05,0.000179487,8.478600000000001e-05,4.9591e-05,4.020273e-06),
(1.25,5.994352950080261e-05,2.579098583424118e-05,0.00015568216482080076,0.0031218853274121,-3.4512000000000005e-06,-6.177600000000001e-06,-7.864e-07,7.636872000000001e-05,0.00040232,0.0001820376,9.58216e-05,1.5841232e-05),
(1.5,8.526766334333578e-05,0.0002053910065706686,0.0012920143777673423,0.008312903079009285,-4.833333333333333e-06,-4.746666666666666e-06,1.927133333333333e-05,0.00018352613333333332,0.0005874733333333334,0.00026151933333333336,0.000135748,2.6615066666666665e-05),
(1.75,0.00010526332798114478,0.0018226190295417537,0.0033688806591961017,0.01471130492462762,-2.794285714285714e-06,1.8102857142857143e-05,6.392571428571428e-05,0.00024386177142857144,0.0007129428571428572,0.00032570285714285716,0.000174564,3.058594285714286e-05),
(1.9,0.00011143588369421201,0.002871030586079088,0.0049368470879952615,0.017761551179197185,-3.021052631578948e-06,3.163684210526316e-05,7.327368421052632e-05,0.0002519938421052632,0.0007407,0.0003330842105263158,0.00018810631578947368,3.384873684210527e-05),
(2.0,0.00011158266692150134,0.005146649298551668,0.005984248601469872,0.020589817098095473,-4.129999999999999e-06,2.0847619047619046e-05,7.697142857142857e-05,0.00025792175,0.0007585700000000001,0.00036888095238095235,0.00017350095238095236,3.5398325e-05),
(2.25,0.000563183561018684,0.007019860795595657,0.011291314106719626,0.025381453227666165,-7.377333333333333e-05,1.655111111111111e-05,8.918222222222222e-05,0.00028057608888888897,0.0008562933333333334,0.0003780266666666667,0.00020010977777777778,3.239177777777778e-05),
(2.5,0.0025185604368283495,0.009152614820030727,0.015284102710438244,0.022543674590890145,-0.000151448,-8.341999999999998e-05,3.8732e-05,0.00027657356,0.000906472,0.00043531200000000004,0.0002332324,1.942936e-05),
(3.0,0.005900553896688389,0.014074516893763399,0.014098193955196093,0.008536815345482814,-0.0003623333333333333,-0.00019352000000000003,2.659999999999999e-06,0.000139038,0.0010283199999999999,0.00048254999999999994,0.00023792333333333334,2.5218866666666663e-05),
(3.5,0.006850908963020407,0.008117298437492064,0.007308024469098757,0.007658863773308402,-0.0004740857142857143,-0.00015347714285714287,2.794e-05,0.000129014,0.0011524371428571429,0.0005163028571428572,0.00029934571428571425,0.005142933428571428),
(4.0,0.0035140877937383038,0.005222656720688887,0.008357721154151919,0.008388833968987817,-0.000413,-0.000104375,4.927500000000001e-06,0.000162464,0.0012680925000000001,0.000521165,0.00574942,0.00657512025),
(4.5,0.0031249933276168095,0.009017836973511955,0.011228763460089681,0.006082325407780398,-0.000516088888888889,-0.0002518888888888889,-0.00019288222222222225,0.00010618311111111111,0.001425511111111111,0.008132077777777778,0.009999484444444444,0.004977879111111111),
(5.0,0.002907932851400165,0.010536572440520713,0.01382586133848302,0.005645047194578995,-0.0007379000000000001,-0.00076508,-0.0005516519999999999,8.300619999999998e-05,0.0023764800000000003,0.01071878,0.012939557999999999,0.004800120800000001),
(5.5,0.0043471333503460755,0.008113843905150107,0.009030834949548112,0.005817689075270635,-0.001095181818181818,-0.0008134909090909092,-0.0005814545454545455,6.790199999999999e-05,0.006178309090909092,0.008362361818181818,0.008654027272727273,0.005072881818181819),
(6.0,0.006033882201744681,0.006782723021368782,0.008481677586632206,0.012979801520711633,-0.0028309910256410263,-0.0013011000000000001,-0.0009703916666666667,0.00017710016666666666,0.011657015384615386,0.007948735,0.008816195,0.011884131666666665)])

FRUITY_yields= np.array([
(1.3,7.284908020655392e-05,5.4631415384838396e-05,0.00012499188655750774,0.0001810824430576693,0.000613771493845715,0.0009276278186101909,0.0016703184433629684,0.001773812644717429,0.0022179367994028085,0.0022179367994028085,-4.855230769230769e-06,-3.0301538461538465e-06,-3.7303846153846153e-06,-1.3602307692307693e-06,9.836076923076922e-06,2.1309246153846155e-05,4.518206923076923e-05,4.899944615384615e-05,6.543460999999999e-05,6.543460999999999e-05,0.0004995711,0.00037541731538461536,0.0002756485923076923,0.00022801216923076922,0.00017956334615384614,9.860866923076923e-05,7.108098615384614e-05,4.0027262307692306e-05,2.037931076923077e-05,2.037931076923077e-05),
(1.5,0.001119611291839193,0.001293647721933153,0.001573801872599548,0.0014883874301866032,0.0022358333904205596,0.002385062652153025,0.0034351877698052206,0.0035474346767088746,0.004373295974281041,0.004373295974281041,-1.21876e-05,5.612733333333332e-06,2.0708533333333337e-05,2.2469600000000003e-05,4.4019266666666674e-05,5.792198666666667e-05,9.118426666666667e-05,9.434836e-05,0.00011897561000000001,0.00011897561000000001,0.0006513795333333333,0.000467486,0.0003571584266666666,0.00029356696,0.0002203671466666667,0.00011819456666666666,8.554385333333333e-05,4.755792733333333e-05,2.5644225333333332e-05,2.5644225333333332e-05),
(2.0,0.0037973232662461822,0.00359628348445006,0.004469110088719462,0.004235730074683002,0.00517992011633738,0.005719887903800857,0.006801482434599383,0.006621168001671054,0.00714481597402462,0.00714481597402462,-3.43991e-05,1.2100850000000001e-05,4.445375e-05,5.428225e-05,8.43186e-05,0.0001193504,0.0001459308,0.00014156298,0.000148962205,0.000148962205,0.0008992825,0.0006440499,0.0004831202,0.00039853735,0.00030767011999999997,0.000167369025,0.00011853147,6.6138195e-05,3.15767345e-05,3.15767345e-05),
(2.5,0.0060190831637778495,0.005396982009050929,0.006541979433850693,0.006524674197248358,0.007120055178654652,0.005450605160800503,0.005493544735508241,0.005223336376857103,0.004277672404998314,0.004277672404998314,-0.00023662640000000004,-0.00013878835999999998,-5.193224000000001e-05,-2.006656e-05,2.221496e-05,5.584651999999999e-05,8.0287e-05,9.874084799999999e-05,8.8121436e-05,8.8121436e-05,0.00115866824,0.00085783184,0.00064585292,0.00054056844,0.00041677944,0.000221662584,0.000147442924,7.143241999999999e-05,2.5335308800000003e-05,2.5335308800000003e-05),
(3.0,0.005181084935556808,0.004403535291350514,0.00402613887112715,0.0036657419817734452,0.0029854515847403326,0.0022252341875930964,0.0026493382534117983,0.002653653082943446,0.0025917138312743283,0.0025917138312743283,-0.00036452733333333334,-0.0002547,-0.00016713093333333332,-0.00012635033333333333,-7.660679999999999e-05,8.031233333333334e-06,4.675959999999999e-05,5.3473343333333336e-05,5.460414000000001e-05,5.460414000000001e-05,0.0013230414333333335,0.0009984760666666666,0.0007581345,0.0006248353333333334,0.0004672683,0.00022292064666666668,0.00013861385333333333,6.776363333333334e-05,2.7297087e-05,2.7297087e-05),
(4.0,0.0007873003376101162,0.0005322682959153327,0.0006034469476012947,0.0006219503445804278,0.0010191542695187625,0.001093687652428057,0.001551628720765891,0.0015047154255122418,0.002237312384317219,0.002237312384317219,-0.00041754849999999996,-0.00030576649999999997,-0.00023434824999999998,-0.00017542285,-0.0001044046,-4.0311550000000005e-05,-1.279705e-05,7.3081500000000005e-06,2.2724505e-05,2.2724505e-05,0.0015409900000000001,0.0011039466,0.0008346414750000001,0.0006665390500000001,0.00048529505,0.000249462675,0.00017674288,9.899786e-05,5.1255465e-05,5.1255465e-05),
(5.0,0.00029810036994619177,0.0003611262764859339,0.00044551573560223153,0.0005645259946790296,0.0005408515291912064,0.0008859506122013917,0.0012785977795828902,0.0013083840393930586,0.0018734868197737727,0.0018734868197737727,-0.0007355186,-0.000514213,-0.00034704639999999997,-0.0002792006,-0.00021690235999999996,-0.00010476341999999999,-5.525694e-05,-1.2166799999999998e-05,3.6233599999999996e-06,3.6233599999999996e-06,0.00196920158,0.00139171886,0.0009752228,0.0007930489400000001,0.0006143789200000001,0.00032980808,0.00022844826,0.00012440628,7.5057562e-05,7.5057562e-05),
(6.0,0.000223635359216805,0.0002907675515273735,0.00042079326516222056,0.0004359083871570703,0.00042345162415994355,0.0005089246487452694,0.0006772862029112181,0.0010343654167358472,0.000994444998590691,0.000994444998590691,-0.0010103586666666668,-0.0006801436666666667,-0.00048517000000000005,-0.000389059,-0.00029826633333333337,-0.00015600616666666667,-9.25923e-05,-2.86057e-05,-2.9902911666666668e-05,-2.9902911666666668e-05,0.0022929434999999997,0.0015802669166666667,0.0011325997333333333,0.0009176968999999999,0.0007149348333333333,0.0003996601,0.0002786548666666667,0.0002845953933333333,0.0002060439033333333,0.0002060439033333333)])

KA18_low_yields= np.array([
(1.0,0.012267152717969597,0.0059224800538473,0.0028131113416939003,4.6927323506900005e-06,0.0003248844389864419,0.00524461,0.00251199,0.00118895,-5.70281e-06,0.0001397754,0.00096258,0.000474836,0.000241779,4.44708e-05,1.687969e-05),
(1.25,0.015210957604633596,0.007384852885457283,0.003557459390794881,0.0010713663417421602,0.0004692393708147464,0.0064909040000000005,0.0031260240000000003,0.001502656,5.4702560000000004e-05,0.00020188136000000003,0.001468568,0.0007291408,0.0003694848,8.25592e-05,2.4379784e-05),
(1.5,0.017179044531257997,0.008307618800160873,0.004243363545403331,0.0021811433916816662,0.0005555251932084218,0.0073196,0.0035097600000000002,0.0017125266666666668,7.695733333333334e-05,0.0002390042,0.0018485333333333335,0.0009304933333333333,0.0004603393333333333,0.00011867333333333334,2.8862846666666666e-05),
(1.75,0.01857259989005713,0.008981614269188578,0.005926486135662288,0.004269862188317143,0.0,0.0079036,0.00378972,0.001915537142857143,0.0001539697142857143,0.0,0.00214756,0.0010671142857142859,0.0005436628571428571,0.000143996,0.0),
(2.0,0.019575770252988504,0.01238286488151899,0.007281440613364999,0.007334530105492998,0.000653578871620653,0.0083455,0.004072705,0.0019884,0.0001861315,0.0002811899,0.00202671,0.00111671,0.000552835,0.000162804,3.3957325e-05),
(2.25,0.020370121255328444,0.01308176427845778,0.010666342621280002,0.009500257127395557,0.0006843541256620039,0.008684711111111111,0.004257288888888888,0.0022817555555555554,0.00024549244444444445,0.00029443039999999996,0.0020805733333333336,0.0011876222222222221,0.0006357377777777778,0.00019157733333333333,3.555628444444444e-05),
(2.5,0.021026264401137994,0.014801183535344,0.012644659123923997,0.011198477616423999,0.000699328198934408,0.00879932,0.0043648,0.002308396,0.0002137968,0.00030087272000000004,0.002475212,0.001345112,0.000738776,0.0002297328,3.6334276e-05),
(2.75,0.022595505410951268,0.01675055946548727,0.01498124521484364,0.010805424635687271,0.0007115127403718693,0.008962872727272727,0.004437018181818182,0.0023271563636363636,0.00019356,0.00030611487272727274,0.002737941818181818,0.0014402836363636361,0.0007763018181818182,0.00019680036363636366,3.6967345454545456e-05),
(3.0,0.024990476074426664,0.017984278748716675,0.015135485865169999,0.008873763276300002,0.00071832951871181,0.0090706,0.0043704,0.0022752533333333332,0.00012522566666666666,0.00030904766666666665,0.0028550366666666668,0.00155671,0.0008151166666666667,0.00021555299999999997,3.73215e-05),
(3.25,0.027663553632129224,0.01910581876968614,0.01422638783088,0.0066199904903753845,0.0007229975700909933,0.009121846153846154,0.004447076923076923,0.0022897846153846152,0.00012298584615384617,0.000311056,0.0029007538461538465,0.0016314861538461538,0.00084076,0.00020283384615384616,3.7564030769230766e-05),
(3.5,0.02973840877918858,0.018576934423997132,0.013188534109562852,0.005544829490461714,0.0007371705367454712,0.009123314285714284,0.004529171428571429,0.0023358371428571427,0.0001245897142857143,0.0003171537142857143,0.0030756,0.0016337771428571429,0.0008363171428571429,0.00024534857142857145,3.83004e-05),
(3.75,0.030140307433501334,0.017858065206895996,0.011940371395016,0.005162261192863735,0.0,0.009237546666666667,0.004542346666666667,0.00238916,3.3918133333333337e-05,0.0,0.0030956800000000004,0.0017090719999999998,0.0008071199999999999,0.000575608,0.0),
(4.0,0.0279716552256225,0.016447610476349,0.010772129524996999,0.004633229119654497,0.0007606591909540877,0.009310275,0.00453865,0.00233243,9.997875e-06,0.00032725925,0.003316925,0.001695295,0.0008497125,0.000408575,3.9520775e-05),
(4.5,0.025541693878299108,0.01724460073650734,0.016372576515065344,0.004898233165211754,0.0007791685251468182,0.009449977777777778,0.004559555555555556,0.002111577777777778,-7.756155555555556e-05,0.00033522244444444445,0.0033411555555555557,0.005098022222222222,0.010748155555555555,0.0042412,4.0482466666666664e-05),
(5.0,0.026466817356199008,0.018064214615466187,0.015404777479219606,0.010846228850498364,0.0007930051109880298,0.00931462,0.0044281599999999996,0.0017297139999999998,-0.00054835,0.0003411754,0.0038189,0.0078003199999999995,0.01015868,0.01055404,4.120136e-05),
(5.5,0.026862152739561437,0.01805895047932453,0.01377147067534491,0.003038705873061374,0.000803697081317218,0.009245509090909092,0.004073363636363636,0.0014431363636363637,-0.0004131581818181818,0.00034577545454545454,0.0052586,0.008400727272727273,0.00917269090909091,0.0034195818181818184,4.1756854545454545e-05),
(6.0,0.027261975063643324,0.017177357490225156,0.010865873129382326,0.0021091637035311407,0.0008109723284793164,0.009165283333333333,0.00373655,0.0012667516666666667,-0.0005333983333333333,0.0003489055,0.0073169,0.007999433333333333,0.0066894833333333336,0.0027592333333333334,4.213485e-05),
(7.0,0.026955540028921438,0.015136314565501716,0.008066726330224294,0.0008651616872986034,0.000816551518066608,0.008862057142857144,0.0035205285714285718,0.001368242857142857,-0.0006493157142857143,0.0003513058571428572,0.008396442857142857,0.006584171428571428,0.004066514285714286,0.0017262142857142858,4.242472857142857e-05)])

KA18_high_yields= np.array([
(1.0,0.012267152717969597,0.0059224800538473,0.0028131113416939003,4.6927323506900005e-06,0.0003248844389864419,0.00524461,0.00251199,0.00118895,-5.70281e-06,0.0001397754,0.00096258,0.000474836,0.000241779,4.44708e-05,1.687969e-05),
(1.25,0.015210957604633596,0.007384852885457283,0.003557459390794881,0.0011216877088984795,0.0004692393708147464,0.0064909040000000005,0.0031260240000000003,0.001502656,8.08136e-05,0.00020188136000000003,0.001468568,0.0007291408,0.0003694848,8.1852e-05,2.4379784e-05),
(1.5,0.017179044531257997,0.010518304881136668,0.005294819195682667,0.0022043657100772,0.0005555251932084218,0.0073196,0.0036715800000000002,0.00178586,0.000137732,0.0002390042,0.0018485333333333335,0.0009491399999999999,0.00046484,0.00011755666666666668,2.8862846666666666e-05),
(1.75,0.01857259989005713,0.011506736769692568,0.007584878843530286,0.004269862188317143,0.0,0.0079036,0.003951171428571429,0.00205188,0.0001539697142857143,0.0,0.00214756,0.0010804057142857143,0.000552564,0.000143996,0.0),
(2.0,0.019575770252988504,0.012444535290380003,0.011999635448940007,0.007470092370404999,0.000653578871620653,0.0083455,0.004143065,0.002566975,0.000351816,0.0002811899,0.00202671,0.001116975,0.000715205,0.0001597435,3.3957325e-05),
(2.25,0.020370121255328444,0.01308176427845778,0.014049621248804446,0.009500257127395557,0.0006843541256620039,0.008684711111111111,0.004257288888888888,0.0025648844444444447,0.00024549244444444445,0.00029443039999999996,0.0020805733333333336,0.0011876222222222221,0.0008208622222222223,0.00019157733333333333,3.555628444444444e-05),
(2.5,0.027388223172532,0.014801183535344,0.016479369736327992,0.0112894599578328,0.000699328198934408,0.00901708,0.0043648,0.002559872,0.00030484319999999997,0.00030087272000000004,0.002341284,0.001345112,0.000853932,0.00023129359999999997,3.6334276e-05),
(2.75,0.027849628814690896,0.01675055946548727,0.016550910843465452,0.010805424635687271,0.0007115127403718693,0.00900850909090909,0.004437018181818182,0.0025396399999999997,0.00019356,0.00030611487272727274,0.0027110181818181815,0.0014402836363636361,0.0008889709090909091,0.00019680036363636366,3.6967345454545456e-05),
(3.0,0.027506526095759994,0.01807084317679,0.015411920150120004,0.00891838803301333,0.00071832951871181,0.009069966666666667,0.0044631666666666665,0.0024806,0.00018348433333333333,0.00030904766666666665,0.0028466933333333336,0.0015562766666666666,0.0009108233333333333,0.00022898666666666667,3.73215e-05),
(3.25,0.027663553632129224,0.019132355343363057,0.014203036733375382,0.0066199904903753845,0.0007229975700909933,0.009121846153846154,0.004492615384615385,0.002515516923076923,0.00012298584615384617,0.000311056,0.0029007538461538465,0.0016313446153846155,0.0009006492307692308,0.00020283384615384616,3.7564030769230766e-05),
(3.5,0.02973840877918858,0.018576934423997132,0.012793255066088562,0.005544829490461714,0.0007371705367454712,0.009123314285714284,0.004529171428571429,0.0025598142857142857,0.0001245897142857143,0.0003171537142857143,0.0030756,0.0016337771428571429,0.0008647714285714285,0.00024534857142857145,3.83004e-05),
(3.75,0.030140307433501334,0.017858065206895996,0.011545057285874669,0.004321136006754669,0.0,0.009237546666666667,0.004542346666666667,0.002562021333333333,8.66008e-05,0.0,0.0030956800000000004,0.0017090719999999998,0.0009068266666666668,0.0002567936,0.0),
(4.0,0.0279716552256225,0.016495068667445007,0.01827826320721501,0.004688164201981503,0.0007606591909540877,0.009310275,0.004592025,0.002365085,8.7747e-05,0.00032725925,0.003316925,0.001697595,0.0119717,0.00039487,3.9520775e-05),
(4.5,0.025565635952853327,0.017263890180375552,0.01711641942135511,0.004901175033481111,0.0007791685251468182,0.009480088888888889,0.0046455333333333335,0.0019219044444444442,-7.075777777777777e-05,0.00033522244444444445,0.003344,0.004823733333333333,0.011287422222222223,0.004233155555555555,4.0482466666666664e-05),
(5.0,0.026466636284791796,0.018066800173900593,0.015148617742879412,0.003969949284955728,0.0007930051109880298,0.00931766,0.00443592,0.00158745,-0.00023557,0.0003411754,0.00382066,0.00779418,0.01008996,0.0039042800000000004,4.120136e-05),
(5.5,0.026862152739561437,0.01805895047932453,0.011853679777507994,0.003038705873061374,0.000803697081317218,0.009245509090909092,0.004073363636363636,0.0013819109090909092,-0.0004131581818181818,0.00034577545454545454,0.0052586,0.008400727272727273,0.0072976181818181825,0.0034195818181818184,4.1756854545454545e-05),
(6.0,0.027261975063643324,0.017177357490225156,0.00941118071859501,0.0021091637035311407,0.0008109723284793164,0.009165283333333333,0.00373655,0.0015962833333333334,-0.0005333983333333333,0.0003489055,0.0073169,0.007999433333333333,0.004744266666666667,0.0027592333333333334,4.213485e-05),
(7.0,0.026955540028921438,0.015136314565501716,0.0,0.0007360639928755712,0.000816551518066608,0.008862057142857144,0.0035205285714285718,0.0,-0.0005955471428571429,0.0003513058571428572,0.008396442857142857,0.006584171428571428,0.0,0.001600857142857143,4.242472857142857e-05)])

Nugrid_yields= np.array([
(1.0,0.008827591685229999,0.004493204657830001,0.0026022951553109994,0.0013606878205461,0.010638983974533998,0.004243,0.002127,0.001921,0.0005767,0.001835,0.0006713,0.0003519,8.937e-05,1.985e-05,7.763e-05),
(1.65,0.013967950868139394,0.00903372967258788,0.01015457265026061,0.012064996314401815,0.01884703200966576,0.006066666666666667,0.003580606060606061,0.004637575757575758,0.003598181818181818,0.005227878787878788,0.0014109090909090911,0.0007563636363636364,0.0002464848484848485,6.278787878787879e-05,3.460606060606061e-05),
(2.0,0.025418004667854998,0.019633753428184998,0.016895869657344995,0.0197676276248855,0.017283384828706658,0.009555,0.006945,0.00665,0.00592,0.004976,0.0017805,0.0009655,0.0003924,8.555e-05,1.935e-05),
(3.0,0.03330052340735334,0.021471586230606663,0.012788870818846663,0.004453358580984666,0.003954878783368135,0.012013333333333334,0.0074399999999999996,0.005256666666666666,0.0013413333333333333,0.000927,0.002391,0.0012723333333333334,0.0005646666666666667,7.376666666666667e-05,1.136e-05),
(4.0,0.0251601577845,0.013898846784149998,0.0073910562399700005,0.0047118993862125,0.004162449263667749,0.00961,0.004955,0.003755,0.00157,0.00102,0.0026025,0.0014595,0.0007135,0.001953,0.0025475),
(5.0,0.020913300139788007,0.011459046086700002,0.005117390672761999,0.0018640920012340002,0.00115014365637652,0.007846,0.003994,0.002852,0.0002434,3.6660000000000005e-05,0.003356,0.003118,0.0014878,0.0012645999999999998,0.0009384),
(6.0,0.018477525917766666,0.011298752870850002,0.005650876837995,0.0012476515012376668,0.0004970469634835502,0.006331666666666667,0.003238333333333333,0.00235,0.00020866666666666668,3.731666666666667e-05,0.006853333333333333,0.0049566666666666665,0.0024216666666666666,0.0008583333333333333,0.00039333333333333337),
(7.0,0.018189765346000003,0.01018060171627143,0.005532583741527143,0.0019763595176442855,0.0018956018644720003,0.006019999999999999,0.002621428571428572,0.002214285714285714,0.0005365714285714286,0.00046414285714285714,0.0067800000000000004,0.004501428571428572,0.0024271428571428573,0.0011317142857142858,0.0011454285714285715),
(12.0,0.05309766510483082,0.05560025455697334,0.06593995761091491,0.07147316475544299,0.07561387328717492,0.010858333333333333,0.010658333333333334,0.0171,0.0222,0.021316666666666668,0.003608333333333333,0.0017833333333333332,0.0010191666666666667,0.00017116666666666666,1.805e-05),
(15.0,0.12050286916048135,0.121244520359092,0.12340643512886901,0.13263467912960197,0.12426822418585222,0.05468,0.05058666666666667,0.050513333333333334,0.06813333333333334,0.05926,0.003332,0.0017433333333333333,0.00097,0.00017853333333333333,2.0333333333333334e-05),
(20.0,0.12736678138423996,0.18281369645987303,0.18032693026172592,0.18422180904831897,0.1861856326222084,0.078,0.0911,0.08205,0.09755,0.11605000000000001,0.003469,0.001768,0.0011085,0.00020040000000000002,0.0010865),
(25.0,0.0097132097456064,0.0060126961714668,0.008124603978232003,0.0678419522975512,0.07477247210509354,0.0036956,0.0017856,0.0018948,0.04604,0.05248,0.0020216,0.0019412,0.0013196,0.00023391999999999998,0.0010808)])

LC06_Molla_yields = np.array([
(11.0,0.008432499999999999,0.00852864,0.008867300000000002,0.012753,0.0170973,0.030206999999999998,0.063809,0.0,5.95e-05,0.000238,0.00239,0.00478,0.012,0.0305,2.05e-09,1.31e-05,5.25e-05,0.000526,0.00105,0.00264,0.00666),
(12.0,0.016149999999999998,0.01629157,0.0167373,0.021967,0.027787,0.045359,0.08968699999999999,0.00575,0.0058,0.00596,0.00782,0.00989,0.0162,0.0321,2.32e-09,1.41e-05,5.68e-05,0.000568,0.00114,0.00285,0.00714),
(13.0,0.024978105,0.0252082,0.025677,0.032478,0.040056999999999995,0.0626563,0.1193652,0.0106,0.0107,0.0108,0.013,0.0155,0.0228,0.0412,2.53e-09,1.38e-05,5.53e-05,0.000553,0.0011,0.00277,0.0069),
(14.0,0.033427207,0.0336827,0.034269,0.042243,0.051089,0.07767740000000001,0.144209,0.0154,0.0155,0.0157,0.0189,0.0224,0.033,0.0595,2.72e-09,1.31e-05,5.26e-05,0.000526,0.00105,0.00263,0.00656),
(15.0,0.040512296,0.0407457,0.041576,0.050644999999999996,0.060922,0.09131149999999999,0.167018,0.0194,0.0195,0.0198,0.0233,0.0273,0.039,0.068,2.88e-09,1.28e-05,5.1e-05,0.00051,0.00102,0.00255,0.00633),
(16.0,0.053026235,0.053255500000000004,0.054036,0.06323,0.073484,0.1039675,0.180834,0.0262,0.0263,0.0266,0.03,0.0338,0.0451,0.0737,2.91e-09,1.2e-05,4.78e-05,0.000477,0.000961,0.0024,0.00595),
(17.0,0.063912181,0.0642538,0.065008,0.074254,0.084537,0.115664,0.193155,0.0322,0.0323,0.0326,0.0357,0.0391,0.0496,0.0758,2.92e-09,1.16e-05,4.66e-05,0.000466,0.000926,0.00232,0.0058),
(20.0,0.09018705199999999,0.09051587999999999,0.0915613,0.10308099999999999,0.115534,0.1536553,0.248977,0.0466,0.0467,0.0471,0.0519,0.0569,0.0726,0.112,2.97e-09,1.02e-05,4.09e-05,0.000409,0.000818,0.00205,0.00513),
(25.0,0.133913172,0.1340541,0.1352047,0.147433,0.160939,0.20097030000000002,0.302896,0.0788,0.0788,0.0794,0.0844,0.09,0.106,0.148,0.00048,0.000487,0.000508,0.000758,0.00104,0.00188,0.00404),
(30.0,0.15453749000000003,0.1549665,0.1561865,0.169931,0.186434,0.23350840000000003,0.3534218,0.099,0.0993,0.0998,0.106,0.114,0.136,0.192,0.000587,0.000594,0.000614,0.000864,0.00114,0.00197,0.00405),
(35.0,0.194667208,0.19478214,0.196405,0.203984,0.21304399999999998,0.240734,0.310377,0.124,0.124,0.125,0.127,0.13,0.139,0.161,0.000791,0.000803,0.000838,0.00126,0.00173,0.00312,0.00669),
(40.0,0.21495715499999998,0.21508509,0.21568089999999998,0.218635,0.223855,0.235945,0.26962500000000006,0.144,0.144,0.144,0.141,0.139,0.13,0.11,0.000462,0.000478,0.000526,0.0011,0.00174,0.00367,0.00847),
(50.0,0.24287008139999997,0.24308437,0.2425573,0.24128400000000003,0.239798,0.234643,0.22405599999999998,0.172,0.172,0.171,0.164,0.156,0.132,0.0724,1.28e-07,2.01e-05,8.03e-05,0.000802,0.0016,0.00401,0.01),
(60.0,0.267615118,0.26782898000000005,0.2662885,0.259598,0.254593,0.233744,0.186021,0.197,0.197,0.195,0.183,0.172,0.133,0.0385,1.08e-07,2.13e-05,8.49e-05,0.000848,0.00169,0.00424,0.0106),
(80.0,0.297263165,0.29735280000000003,0.29690570000000005,0.288205,0.27793599999999996,0.249386,0.179185,0.227,0.227,0.226,0.211,0.194,0.145,0.0223,8.29e-08,2.14e-05,8.55e-05,0.000854,0.00171,0.00427,0.0107),
(100.0,0.316043193,0.31626180000000004,0.3147378,0.301792,0.288749,0.24723679999999998,0.14426999999999998,0.246,0.246,0.244,0.225,0.205,0.143,-0.0125,6.78e-08,2.1e-05,8.36e-05,0.000836,0.00168,0.0042,0.0105)])

MA92_yields_extra = np.array([
(9,0.03,0.019222222222222,0.000444444444444,0,0,0.00011111111),
(12,0.069166666666667,0.057166666666667,0.0125,0.009166666666667,0,0.00016666666),
(15,0.102,0.088,0.030666666666667,0.027333333333333,0,0.0002),
(20,0.1465,0.1365,0.0635,0.0635,0,0.0002),
(25,0.178,0.1792,0.096,0.1028,0,0.00228),
(39.99,0.24275,0.20025,0.17,0.052,0,0.00425),
(40,0,0.16,0,0.0365,0,0.00425),
(60,0,0.144833333333333,-0.00003333333,0.017166666666667,0.00005,0.00415),
(85,0,0.208823529411765,-0.00005882352,0.03964705882353,0.00008235294,0.00362352941),
(120,0,0.07825,-0.00010833333,-0.00106666666,0.00015,0.00550833333)])

MM02_000_yields = np.array([
(9,0.00566666666,0.000444444444444,0.019222222222222,0.000444444444444,0.001777777777778,0.,2.44444444444444E-06,0.0006,0.00011111111),
(15,0.05733333333,0.016666666666667,0.088,0.012666666666667,0.053333333333333,0.027333333333333,2.33333333333333E-06,0.000666666666667,0.0002),
(20,0.085,0.0425,0.1365,0.028,0.09,0.0635,2.3E-06,0.0008,0.0002),
(40,0.1825,0.1325,0.16,0.125,0.1825,0.0365,2.5E-06,0.001075,0.00425),
(60,0.21666666666,0.2,0.144833333333333,0.183333333333333,0.233333333333333,0.017166666666667,2.66666666666667E-06,0.001133333333333,0.00415)])

LC18_R000_yields = np.array([
(13.0,0.040044909442666074,0.04775681428846545,0.04804504257516125,0.05015304465935891,0.013911538461538463,0.019740769230769232,0.020850769230769232,0.022326153846153846,0.0019311538461538461,0.0005304153846153847,5.9451538461538463e-05,7.228153846153846e-06),
(15.0,0.07571021812657995,0.09722562458500207,0.07384046723277556,0.09557434629585797,0.03392133333333334,0.05546466666666667,0.03709866666666666,0.053958,0.0018233333333333333,0.00047796666666666667,5.8774666666666665e-05,6.3858e-06),
(20.0,0.11799841319487729,0.12704734939370652,0.12908181923999734,0.13167112942612877,0.057530000000000005,0.06494,0.067945,0.070935,0.00154885,0.000481475,5.3025e-05,6.169999999999999e-06),
(25.0,0.17018833470413694,0.1698324252076719,0.16516282305538785,0.17086362824766535,0.09374,0.10628399999999999,0.09484,0.10456,0.0017335200000000001,0.00044224,5.9376e-05,6.0811999999999995e-06),
(30.0,-4.146724029890015e-05,-1.545573394551333e-08,5.263200812197672e-10,-4.900716115170329e-10,-0.0012215333333333333,-9.814333333333334e-09,3.3663333333333335e-10,-3.0993999999999997e-10,0.0018148666666666668,-3.007166666666667e-10,1.0969e-11,-1.0552333333333335e-11),
(40.0,-7.114793004687232e-05,-6.0378510046660914e-06,1.7340888829702502e-09,-1.605351628222001e-11,-0.001543625,-7.555249999999999e-05,1.09355e-09,-1.018375e-11,0.0021637,8.876999999999999e-05,3.77875e-11,-3.4645e-13),
(60.0,0.006524840097714429,-1.420735658812615e-05,-1.203044899473667e-09,6.803430505638336e-11,-0.0016499833333333334,-0.00017238333333333334,-7.485166666666666e-10,4.3243333333333336e-11,0.0029596666666666664,0.00019958333333333332,-2.6355e-11,1.4583000000000002e-12),
(80.0,0.014923501895809396,-4.570835019093056e-05,5.879911251617506e-10,1.8809049704225007e-10,-0.001103925,-0.00052305,4.033625e-10,1.1883250000000001e-10,0.003070875,0.0005875375,1.1912125000000001e-11,4.056375e-12),
(120.0,0.018124049974605583,0.0029092705880280735,-3.706710226309238e-07,-1.1767968851892498e-09,-0.0013585,0.0002731333333333333,-4.411083333333333e-06,-7.441583333333333e-10,0.0036110833333333333,0.0008403333333333333,5.003916666666666e-06,-2.5355e-11)])

LC18_R150_yields = np.array([
(13.0,0.14880176289748925,0.1667843482374842,0.169824594038595,0.15840440393176605,0.09632307692307693,0.09527692307692306,0.11363846153846155,0.11223846153846154,0.002446,0.005362846153846154,0.0046417692307692306,0.002587230769230769),
(15.0,0.1906641918901506,0.19016541239552018,0.18990088598231233,0.1967959538609105,0.12355999999999999,0.12568,0.1107,0.13414666666666666,0.0021523333333333334,0.006348933333333333,0.004668533333333334,0.0011796),
(20.0,0.2123397111074495,0.23672986796422707,0.21692847641468896,0.21417522784770268,0.12598,0.1661,0.155125,0.156285,0.0028058,0.006784,0.005043000000000001,0.0026488500000000003),
(25.0,0.23990479367741996,0.2748872686276508,0.25945261540380804,0.25829836280493296,0.140564,0.19444,0.18539999999999998,0.188192,0.00282524,0.00334536,0.000325248,0.0034628),
(30.0,0.01211723026716512,-8.356756537281043e-06,-4.292695467042325e-07,3.0282726248091774e-06,-0.00012551666666666666,-0.00010679333333333334,-9.179333333333332e-06,-1.0321e-07,0.0031425,0.00012675333333333333,1.2648333333333332e-05,3.1176666666666664e-06),
(40.0,0.014763008874268646,-4.8535075229699825e-05,0.0008014779100675786,-5.6315656972616635e-08,-0.000338125,-0.00062325,8.993e-05,-2.5695e-06,0.0035770000000000003,0.000743625,0.00042640000000000006,3.99075e-06),
(60.0,0.021367387516842355,0.018920629835592066,0.00147675571943158,-6.083439964197378e-08,-0.000104245,0.0015131,0.0003616333333333333,-2.0993333333333334e-06,0.0035608333333333334,0.0007560166666666666,0.00047021666666666667,3.1361666666666667e-06),
(80.0,0.02497805744565232,0.026834180708078168,0.0028615236027802714,-1.4348142829654902e-07,0.00039543750000000006,0.00318,0.0007997375,-2.957875e-06,0.003701625,0.0006887250000000001,0.0005388249999999999,3.9765e-06),
(120.0,0.018733002872365262,0.017985130129846434,0.006878292646977934,5.314932443581019e-06,-0.00161275,0.0010986666666666668,0.001924,-4.963666666666667e-06,0.004216083333333333,0.0009715,0.000514125,1.1400000000000001e-05)])

LC18_R300_yields = np.array([
(13.0,0.18799110766215218,0.2040857850743215,0.20950008243542187,0.19594303373058797,0.10996923076923076,0.10193846153846153,0.10026153846153846,0.12036923076923077,0.003458,0.004016923076923077,0.0053961538461538465,0.01051),
(15.0,0.22282746767516928,0.23167145805954734,0.2176948626757873,0.207451337060014,0.12318666666666668,0.11696666666666666,0.11206666666666668,0.12582666666666667,0.004309599999999999,0.004567666666666667,0.0043937333333333335,0.010199999999999999),
(20.0,0.2336333332612099,0.23065869356002605,0.24767177651341207,0.21180597812530738,0.14266,0.16101000000000001,0.18723499999999998,0.148005,0.006028,0.0029205999999999998,0.0008569000000000001,0.0007261),
(25.0,0.26046550137236396,0.3223709844566808,0.3372518550575603,0.33613217025433856,0.15091200000000002,0.22331199999999998,0.23765599999999998,0.23714,0.00356668,0.00219792,0.0005013999999999999,0.0007892),
(30.0,0.015643996452530895,0.0002827963008626974,0.0018448992448583431,-1.3206514091612925e-07,-0.0003378333333333333,-0.0004979333333333334,0.00017296333333333334,-3.6446666666666666e-06,0.0039503333333333335,0.0009489333333333334,0.0005019666666666666,5.3226666666666665e-06),
(40.0,0.01923095534200449,0.0053968844283540365,0.0026393874141958503,-7.831085777119932e-08,-0.00048312499999999994,0.0009170249999999999,0.000456475,-2.92875e-06,0.00391475,0.0021971,0.00122865,4.47325e-06),
(60.0,0.015656588399484094,0.022656081984753655,0.006764691881556295,-1.2055030249390614e-07,-0.0020431666666666667,0.0023074999999999997,0.0012946666666666666,-3.212166666666667e-06,0.004226833333333333,0.0009636,0.0012700833333333334,4.603e-06),
(80.0,0.012116755962895626,0.020636280625510563,0.008749906265396247,0.0003557491537625982,-0.0027772499999999998,0.0016601250000000001,0.001553375,6.563625e-05,0.004881125,0.0007952625,0.0007846499999999999,0.0002672),
(120.0,0.009414244302005484,0.018418955973978628,0.01336333964352895,4.285439307740937e-06,-0.0035055,0.0011882499999999999,0.0025640833333333336,-4.129083333333333e-06,0.005617,0.0009903333333333333,0.0004999666666666667,9.524166666666668e-06)])

Davis_AGB_yields = np.array([
(1.0,2.691273596155952e-05,1.176565359628512e-05,6.128900878366039e-06,0.0002669994162018685,-1.8900633449447923e-06,-3.4184363357780967e-06,-4.698614247899968e-06,1.1443221410445403e-05,0.00017912821203935891,8.478540985379368e-05,4.9605117965256795e-05,4.019394509668928e-06,-4.25939992576e-09,-4.25939992576e-09,-4.25939992576e-09,-4.25939992576e-09),
(1.25,5.93618437051191e-05,2.5272840093748528e-05,0.00015504442844875842,0.0031214287572943534,-3.4445565688656643e-06,-6.1780840042047204e-06,-7.835285941837356e-07,7.634249632246793e-05,0.00040198396891355515,0.00018188529647886754,9.552844567224383e-05,1.5828969480935484e-05,-1.2311439867903999e-08,-1.2311439867903999e-08,-1.2311439867903999e-08,-1.2311439867903999e-08),
(1.5,8.432342125767416e-05,0.00020402178962619644,0.0012910613017114898,0.008308982961423794,-4.838331127151226e-06,-4.74012116076968e-06,1.9302096916362643e-05,0.00018381932750344276,0.0005875544544930259,0.0002612190049452086,0.00013583875261247158,2.6582226079578202e-05,-1.7219732548266667e-08,-1.7219732548266667e-08,-1.7219732548266667e-08,-1.7219732548266667e-08),
(1.75,0.00010288519791044694,0.0018195859205634793,0.0033662092278336736,0.014690853260609467,-2.79291530854867e-06,1.8128950614482164e-05,6.375934130379132e-05,0.00024407707886504277,0.000712977589241096,0.0003258474836392062,0.00017480101502899612,3.060953999270818e-05,-2.795634238610286e-08,-2.795634238610286e-08,-2.795634238610286e-08,-2.795634238610286e-08),
(1.9,0.00010683895643079753,0.0028667309455108546,0.004932768683062801,0.017720217891245168,-3.0104892505484902e-06,3.167636246698118e-05,7.342317503319821e-05,0.0002521949570019146,0.0007395532173019111,0.00033293416112029756,0.00018804954711155102,3.383094395416356e-05,-3.091815779698227e-08,-3.091815779698227e-08,-3.091815779698227e-08,-3.091815779698227e-08),
(2.0,0.00010621160595292167,0.00417325215286013,0.005540207378298634,0.02053326615118678,-4.153907866566442e-06,2.192717875004746e-05,8.086228626780212e-05,0.0002581605513114482,0.0007572451140731573,0.00038751601823605597,0.0001821815239964053,3.5420340282144025e-05,-3.425009926144e-08,-3.425009926144e-08,-3.425009926144e-08,-3.425009926144e-08),
(2.25,0.0005573704466617831,0.007008992766348143,0.011276376605337646,0.02529838268367257,-7.397736448587643e-05,1.6548864853878815e-05,8.91072559170425e-05,0.00028056703093979094,0.0008573316865497165,0.00037789267177383107,0.00019999424047354195,3.240017233312958e-05,-3.059679989304889e-08,-3.059679989304889e-08,-3.059679989304889e-08,-3.059679989304889e-08),
(2.5,0.0025101450418858915,0.009137341069316563,0.01525412820087695,0.022496379599198237,-0.00015144400531426073,-8.335589664056897e-05,3.874824615195394e-05,0.00027652825228869916,0.0009081619791686535,0.0004355667158961296,0.0002331200521439314,1.9422844343353062e-05,-3.3256518975488e-08,-3.3256518975488e-08,-3.3256518975488e-08,-3.3256518975488e-08),
(3.0,0.005882002594262303,0.014041258800792397,0.01407460349757154,0.008530419635045897,-0.0003619721392169595,-0.0001935649779625237,2.6538321738674617e-06,0.00013899588763403395,0.0010294035697976749,0.0004816108848899603,0.0002379582729190588,2.5232198822777718e-05,-4.872966504448e-08,-4.872966504448e-08,-4.872966504448e-08,-4.872966504448e-08),
(3.5,0.006825421898773649,0.008101981375667882,0.007297793252486632,0.007665292362803809,-0.0004750293280397143,-0.00015334021632692644,2.792711685677724e-05,0.00012889191774385317,0.0011512711644172668,0.0005172600171395711,0.00030068125176642625,0.0051540205521242955,-7.925685663451429e-08,-7.925685663451429e-08,-7.925685663451429e-08,-7.925685663451429e-08),
(4.0,0.003497161811111482,0.0052097686719321246,0.00833795742289567,0.008388194277786809,-0.00041239956044591963,-0.0001043749216478318,4.912820259050932e-06,0.0001623931311769411,0.0012675924226641655,0.0005208965158089995,0.005741173401474953,0.006580772809684277,-8.355650207744e-08,-8.355650207744e-08,-8.355650207744e-08,-8.355650207744e-08),
(4.5,0.003105177250745328,0.008997690883714111,0.011209233807070026,0.00607801699120832,-0.0005156383849680424,-0.0002515344725300868,-0.00019291996593690582,0.00010622848963571919,0.0014247180273135502,0.00813192543056276,0.00999776025613149,0.004977290415101581,-8.581977531278223e-08,-8.581977531278223e-08,-8.581977531278223e-08,-8.581977531278223e-08),
(5.0,0.002878354983886311,0.01051402993780357,0.013803826254661544,0.00564719034039598,-0.0007382174022495747,-0.0007649108301848173,-0.0005515769124031066,8.30217672046274e-05,0.0023702608421444895,0.010724425315856934,0.012947380542755127,0.004805777594447136,-8.7736400740352e-08,-8.7736400740352e-08,-8.7736400740352e-08,-8.7736400740352e-08),
(5.5,0.004315510282636255,0.00808773895245064,0.009019981649296162,0.005819469967568577,-0.0010947160084139216,-0.0008143280548128215,-0.0005813443355939605,6.790744902735406e-05,0.006175049326636575,0.008356832645156166,0.008659332313320854,0.005079482766714963,-8.893745570536726e-08,-8.893745570536726e-08,-8.893745570536726e-08,-8.893745570536726e-08),
(6.0,0.0033367117453811566,0.006756189826470897,0.008464932331510985,0.0062846695423447825,-0.001343297151227792,-0.0013011253128449123,-0.0009698774665594101,0.00010669829013446967,0.006032380585869153,0.00794101320207119,0.008819056674838066,0.0056428685784339905,-8.977483388245334e-08,-8.977483388245334e-08,-8.977483388245334e-08,-8.977483388245334e-08),
(7.0,-6.190465833119291e-05,0.0002698505448636622,0.0006336352486836663,0.00622262356202035,-0.0009355107322335243,-0.00022892692192856754,-0.0002349391413320388,-0.0002285182542566742,0.001922669421349253,0.0004748315883002111,0.0004873019310512713,0.005963809256042753,-3.5828571916291755e-06,-3.5828571916291755e-06,-3.5828571916291755e-06,-3.5828571916291755e-06),
(7.5,-0.00040091055870143064,0.00011535495256490928,0.0004303703258604704,0.0074386721622583234,-0.001024630789955457,-0.00023554970199863117,-0.00023599411360919476,0.000192038140570124,0.0020353443920612334,0.00048077224443356196,0.0004816793215771516,0.006882317364215851,-3.570666740415618e-06,-3.570666740415618e-06,-3.570666740415618e-06,-3.570666740415618e-06)])

Davis_SN_yields = np.array([
(6.0,-0.0031422761579354606,-0.0012558659072965384,-0.0004837070203696688,-0.0002485125830086569,-2.278777052803586e-05,-0.0021840250119566917,-0.0009773366618901491,-0.0005012019925440351,-0.0002936630044132471,-3.0288834144206096e-05,0.004884693461159865,0.0020877133744458356,0.0010324485289553802,0.0005914121478175124,6.767633506873001e-05,-1.8214999727206305e-05,-1.8214999727206305e-05,-7.2483332284415764e-06,-3.606999901724824e-06,-8.977499987850024e-08),
(7.0,-0.0033142694405147006,-0.001307377325637,-0.0005148097407072783,-0.0002640897042251059,-2.503932669891843e-05,-0.0030734786497695105,-0.0015055871169481958,-0.0007095817210418838,-0.00038495530108256,-4.210095669675086e-05,0.0062356383672782355,0.00287297713969435,0.0013238031949315751,0.0007144131564668246,8.34202260843345e-05,0.0,0.0,0.0,0.0,0.0),
(9.0,0.04140370954862899,0.040207341494452625,0.07314062868762347,0.053244377564017974,0.04934980892317577,0.008904342022207048,0.010717992981274923,0.02088711162408193,0.016158666875627305,0.015379000041219924,0.0071172987421353655,0.0034005132814248404,0.0012095666800936062,0.0007443374229802026,8.238333329144452e-05,0.0,0.0,0.0,0.0,0.0),
(12.0,0.10148401527355115,0.09732171574917932,0.10478136343105386,0.10950375278480351,0.1058175197977107,0.051422918836275734,0.05001291632652283,0.05430650214354197,0.05704391499360403,0.05569233496983846,0.006946730737884839,0.003454434064527353,0.001497130064914624,0.0007453979148219029,8.523507858626544e-05,0.0007241111145251327,0.000194516666750941,0.0001454722239739365,0.0001083722195795013,0.00010036111214301652),
(15.0,0.1377121069158117,0.13041282929480075,0.14045626806716124,0.1423730446025729,0.14472815388192733,0.08154799938201904,0.07560866673787435,0.08360466957092286,0.08520600001017252,0.09357666969299316,0.0063625728090604145,0.0033649712800979613,0.001511350025733312,0.0007966006795565287,7.796032975117365e-05,0.0009150666495164236,0.00016920665899912516,0.00010961332979301612,6.453333189710974e-05,2.4416666322698197e-05),
(20.0,0.20966551252640783,0.18653813432902097,0.1969648465514183,0.204606859292835,0.2087016277189832,0.1485599994659424,0.1287269949913025,0.13874449729919433,0.14566149711608886,0.15153100490570068,0.00597429983317852,0.003309580683708191,0.0013893820345401765,0.0007103525102138519,8.68607487063855e-05,0.0018942000344395638,0.0002609800081700087,0.0001488349982537329,6.399999838322402e-05,4.047049969813088e-07),
(30.0,0.14992013961697617,0.12437674552202224,0.13058348961058072,0.13171869930017693,0.14180141432152596,0.07809942563374837,0.09449666341145833,0.09877633253733317,0.09923899968465169,0.10487600167592366,0.007541487614313762,0.0033217966556549072,0.0015485626955827078,0.0008521230270465215,9.208379779011012e-05,0.0005125666658083598,0.00020597333398958046,8.953333211441835e-05,1.4492333624123906e-06,8.97933326389951e-07),
(40.0,0.090174765791744,0.13856801604852081,0.07745494707778562,0.08458799673244358,0.03709747227840125,0.007638850063085556,0.04130074977874756,0.05240499973297119,0.051527750492095944,0.020472049713134766,0.009108675271272659,0.004107600077986717,0.0015816057100892067,0.0008446107618510723,0.00010589887388050556,0.0010183749720454216,0.0003077999921515584,0.00014447499997913838,2.0923750707879662e-05,6.567000127688516e-07),
(60.0,0.08418047053273767,0.13384067194225888,0.20967545527964832,0.08352100538710754,0.013233610662670496,0.003236666570107142,0.03418416579564412,0.07581133047739665,0.05718309879302978,0.004677766561508178,0.014607750376065572,0.004526400069395701,0.00177088330189387,0.0009245071560144424,0.00011156571563333272,3.274144615229707e-05,8.471827942180786e-06,0.00018858642052073106,1.7784134617930855e-05,4.025328105397509e-07),
(100.0,0.053257497386075554,0.1628982514049858,0.23465712154342327,0.08138702630996704,0.16380431381054222,-0.004552200138568878,0.03238529920578003,0.07363377571105957,0.06849380016326904,0.13940500259399413,0.014824800491333008,0.005608590245246887,0.0022255943715572355,0.0010842999815940857,9.07829124480486e-05,0.0017289623239128459,5.346924947358216e-06,0.00010020171303017467,1.527244174597181e-05,5.5454669136654e-07),
(120.0,0.044097174242294084,0.1049294254432122,0.24714797067407895,0.001780442788246243,0.19424296412616968,-0.004357366760571798,0.018932499488194785,0.07254500389099121,-0.00026849759742617605,0.1595408280690511,0.014561416705449422,0.007227408389250438,0.002452949931224187,0.001687241718173027,0.0001134643331170082,0.00789541674732348,1.1036827723891195e-05,7.810553615753558e-05,1.2895604108244251e-05,5.350888934942685e-07)])
 
Davis_AGB_yields_C = np.array([ 
(1.0,2.691273596155952e-05,1.176565359628512e-05,6.128900878366039e-06,0.0002669994162018685,-1.8900633449447923e-06,-3.4184363357780967e-06,-4.698614247899968e-06,1.1443221410445403e-05,0.00017912821203935891,8.478540985379368e-05,4.9605117965256795e-05,4.019394509668928e-06,-4.25939992576e-09,-4.25939992576e-09,-4.25939992576e-09,-4.25939992576e-09,-0.00015021000581327826,-6.943816697457805e-05,-3.861149161821231e-05,0.00025019701570272446,2.47900009398272e-05,9.461829730304e-06,4.38851000598528e-06,1.970029985792e-07),
(1.25,5.93618437051191e-05,2.5272840093748528e-05,0.00015504442844875842,0.0031214287572943534,-3.4445565688656643e-06,-6.1780840042047204e-06,-7.835285941837356e-07,7.634249632246793e-05,0.00040198396891355515,0.00018188529647886754,9.552844567224383e-05,1.5828969480935484e-05,-1.2311439867903999e-08,-1.2311439867903999e-08,-1.2311439867903999e-08,-1.2311439867903999e-08,-0.0003391617676243186,-0.00015009911730885507,5.863488186150789e-05,0.002976386994123459,3.123823988912947e-05,1.1500879815376896e-05,5.27488019070976e-06,3.86979204169728e-07),
(1.5,8.432342125767416e-05,0.00020402178962619644,0.0012910613017114898,0.008308982961423794,-4.838331127151226e-06,-4.74012116076968e-06,1.9302096916362643e-05,0.00018381932750344276,0.0005875544544930259,0.0002612190049452086,0.00013583875261247158,2.6582226079578202e-05,-1.7219732548266667e-08,-1.7219732548266667e-08,-1.7219732548266667e-08,-1.7219732548266667e-08,-0.0004973943966130415,-5.625466777322193e-05,0.0011133639297137659,0.007733928660551707,3.660559824191488e-05,1.307866665320448e-05,6.6972668797474135e-06,5.954180271308799e-07),
(1.75,0.00010288519791044694,0.0018195859205634793,0.0033662092278336736,0.014690853260609467,-2.79291530854867e-06,1.8128950614482164e-05,6.375934130379132e-05,0.00024407707886504277,0.000712977589241096,0.0003258474836392062,0.00017480101502899612,3.060953999270818e-05,-2.795634238610286e-08,-2.795634238610286e-08,-2.795634238610286e-08,-2.795634238610286e-08,-0.0006049908032374722,0.0014194388474736894,0.0030461233109235764,0.013200661965778895,3.500919877983086e-05,1.37245143072768e-05,6.12325702762496e-06,6.621714058912915e-07),
(1.9,0.00010683895643079753,0.0028667309455108546,0.004932768683062801,0.017720217891245168,-3.0104892505484902e-06,3.167636246698118e-05,7.342317503319821e-05,0.0002521949570019146,0.0007395532173019111,0.00033293416112029756,0.00018804954711155102,3.383094395416356e-05,-3.091815779698227e-08,-3.091815779698227e-08,-3.091815779698227e-08,-3.091815779698227e-08,-0.0006263924375547225,0.00240270517056183,0.004505988659118209,0.01563232803824485,3.676547433983618e-05,1.3231421145728286e-05,5.988842427919416e-06,7.489315761946527e-07),
(2.0,0.00010621160595292167,0.00417325215286013,0.005540207378298634,0.02053326615118678,-4.153907866566442e-06,2.192717875004746e-05,8.086228626780212e-05,0.0002581605513114482,0.0007572451140731573,0.00038751601823605597,0.0001821815239964053,3.5420340282144025e-05,-3.425009926144e-08,-3.425009926144e-08,-3.425009926144e-08,-3.425009926144e-08,-0.0006430206703953445,0.0035056485794484615,0.005018740892410278,0.017850760370492935,3.697934898036736e-05,1.3147750204438683e-05,6.2404754022071175e-06,7.6022498197504e-07),
(2.25,0.0005573704466617831,0.007008992766348143,0.011276376605337646,0.02529838268367257,-7.397736448587643e-05,1.6548864853878815e-05,8.91072559170425e-05,0.00028056703093979094,0.0008573316865497165,0.00037789267177383107,0.00019999424047354195,3.240017233312958e-05,-3.059679989304889e-08,-3.059679989304889e-08,-3.059679989304889e-08,-3.059679989304889e-08,-0.0002525668953441911,0.006190195265743468,0.010183512336677976,0.02151190572314792,3.632199916526706e-05,1.2417511616384569e-05,5.734444673997938e-06,7.948800366273423e-07),
(2.5,0.0025101450418858915,0.009137341069316563,0.01525412820087695,0.022496379599198237,-0.00015144400531426073,-8.335589664056897e-05,3.874824615195394e-05,0.00027652825228869916,0.0009081619791686535,0.0004355667158961296,0.0002331200521439314,1.9422844343353062e-05,-3.3256518975488e-08,-3.3256518975488e-08,-3.3256518975488e-08,-3.3256518975488e-08,0.0015638431534171105,0.008092249184846878,0.01352570801973343,0.01968563497066498,3.5843159942496254e-05,1.2248960039124992e-05,5.7078000092446715e-06,5.634400091897856e-06),
(3.0,0.005882002594262303,0.014041258800792397,0.01407460349757154,0.008530419635045897,-0.0003619721392169595,-0.0001935649779625237,2.6538321738674617e-06,0.00013899588763403395,0.0010294035697976749,0.0004816108848899603,0.0002379582729190588,2.5232198822777718e-05,-4.872966504448e-08,-4.872966504448e-08,-4.872966504448e-08,-4.872966504448e-08,0.0046032316361864405,0.012279688070217768,0.012573295583327612,0.007973961532115936,3.656500006354944e-05,1.302183349846016e-05,6.6286001953177605e-06,0.000140628338919779),
(3.5,0.006825421898773649,0.008101981375667882,0.007297793252486632,0.007665292362803809,-0.0004750293280397143,-0.00015334021632692644,2.792711685677724e-05,0.00012889191774385317,0.0011512711644172668,0.0005172600171395711,0.00030068125176642625,0.0051540205521242955,-7.925685663451429e-08,-7.925685663451429e-08,-7.925685663451429e-08,-7.925685663451429e-08,0.0053823185818535945,0.007159145282847541,0.006611650543553489,0.0021306914942605154,3.946142937120768e-05,1.6288372025870627e-05,9.736485928735305e-05,0.0001735485719584066),
(4.0,0.003497161811111482,0.0052097686719321246,0.00833795742289567,0.008388194277786809,-0.00041239956044591963,-0.0001043749216478318,4.912820259050932e-06,0.0001623931311769411,0.0012675924226641655,0.0005208965158089995,0.005741173401474953,0.006580772809684277,-8.355650207744e-08,-8.355650207744e-08,-8.355650207744e-08,-8.355650207744e-08,0.002340703969821334,0.0045191277749836445,0.0022458576131612062,0.0013620792888104916,4.320399944843264e-05,0.00016912774831538176,0.0004183575171694592,0.00010707924699578368),
(4.5,0.003105177250745328,0.008997690883714111,0.011209233807070026,0.00607801699120832,-0.0005156383849680424,-0.0002515344725300868,-0.00019291996593690582,0.00010622848963571919,0.0014247180273135502,0.00813192543056276,0.00999776025613149,0.004977290415101581,-8.581977531278223e-08,-8.581977531278223e-08,-8.581977531278223e-08,-8.581977531278223e-08,0.0019467117057906257,0.000618434873306089,0.0008591222059395579,0.0008423553469280402,6.22673334824687e-05,0.00016510155887971897,0.0001457888852914995,7.791088809250361e-05),
(5.0,0.002878354983886311,0.01051402993780357,0.013803826254661544,0.00564719034039598,-0.0007382174022495747,-0.0007649108301848173,-0.0005515769124031066,8.30217672046274e-05,0.0023702608421444895,0.010724425315856934,0.012947380542755127,0.004805777594447136,-8.7736400740352e-08,-8.7736400740352e-08,-8.7736400740352e-08,-8.7736400740352e-08,0.00104179996997118,-5.226879729889333e-05,0.000672711618244648,0.0006270232144743205,0.0004798000050460426,0.00013113120129233717,0.00014271160135345765,8.102320082937447e-05),
(5.5,0.004315510282636255,0.00808773895245064,0.009019981649296162,0.005819469967568577,-0.0010947160084139216,-0.0008143280548128215,-0.0005813443355939605,6.790744902735406e-05,0.006175049326636575,0.008356832645156166,0.008659332313320854,0.005079482766714963,-8.893745570536726e-08,-8.893745570536726e-08,-8.893745570536726e-08,-8.893745570536726e-08,-0.0010657414624636824,0.00016457872168922967,0.0005936318246478385,0.0005281174724752253,0.00010880400043993274,0.00010930599621748922,0.0001227227243831743,7.357200106830382e-05),
(6.0,0.0033367117453811566,0.006756189826470897,0.008464932331510985,0.0062846695423447825,-0.001343297151227792,-0.0013011253128449123,-0.0009698774665594101,0.00010669829013446967,0.006032380585869153,0.00794101320207119,0.008819056674838066,0.0056428685784339905,-8.977483388245334e-08,-8.977483388245334e-08,-8.977483388245334e-08,-8.977483388245334e-08,-0.0015509131674965222,-0.00016620332219948372,0.0003221240088654061,0.00037456715169052285,9.242016570059436e-05,0.00010879666841015637,0.00010712400055500801,6.456716677873663e-05),
(7.0,-6.190465833119291e-05,0.0002698505448636622,0.0006336352486836663,0.00622262356202035,-0.0009355107322335243,-0.00022892692192856754,-0.0002349391413320388,-0.0002285182542566742,0.001922669421349253,0.0004748315883002111,0.0004873019310512713,0.005963809256042753,-3.5828571916291755e-06,-3.5828571916291755e-06,-3.5828571916291755e-06,-3.5828571916291755e-06,-0.0010531428270041943,1.3142857434494154e-05,0.0003701857224638973,0.0003701857224638973,0.00026757142040878534,0.00021642857297722782,0.00012904285852398192,0.00012904285852398192),
(7.5,-0.00040091055870143064,0.00011535495256490928,0.0004303703258604704,0.0074386721622583234,-0.001024630789955457,-0.00023554970199863117,-0.00023599411360919476,0.000192038140570124,0.0020353443920612334,0.00048077224443356196,0.0004816793215771516,0.006882317364215851,-3.570666740415618e-06,-3.570666740415618e-06,-3.570666740415618e-06,-3.570666740415618e-06,-0.0014169332881768546,-0.00014720000326633452,0.00016732000124951204,0.00016732000124951204,0.000187066663056612,0.000199066661298275,0.00011515999988963207,0.00011515999988963207)])

Davis_SN_yields_C = np.array([
(6.0,-0.0031422761579354606,-0.0012558659072965384,-0.0004837070203696688,-0.0002485125830086569,-2.278777052803586e-05,-0.0021840250119566917,-0.0009773366618901491,-0.0005012019925440351,-0.0002936630044132471,-3.0288834144206096e-05,0.004884693461159865,0.0020877133744458356,0.0010324485289553802,0.0005914121478175124,6.767633506873001e-05,-1.8214999727206305e-05,-1.8214999727206305e-05,-7.2483332284415764e-06,-3.606999901724824e-06,-8.977499987850024e-08,-0.0029587134098013244,-0.001212550016740958,-0.0005534766629959146,-0.00030697717253739637,-3.710140056985741e-05,9.21983349447449e-05,9.21983349447449e-05,0.0001089616659252594,0.00010740499904689689,6.488833363012721e-05),
(7.0,-0.0033142694405147006,-0.001307377325637,-0.0005148097407072783,-0.0002640897042251059,-2.503932669891843e-05,-0.0030734786497695105,-0.0015055871169481958,-0.0007095817210418838,-0.00038495530108256,-4.210095669675086e-05,0.0062356383672782355,0.00287297713969435,0.0013238031949315751,0.0007144131564668246,8.34202260843345e-05,0.0,0.0,0.0,0.0,0.0,-0.003474008558051927,-0.0014738014766148158,-0.0006486431562474795,-0.00034480758144387176,-4.233922975670014e-05,0.0,0.0,0.0,0.0,0.0),
(9.0,0.04140370954862899,0.040207341494452625,0.07314062868762347,0.053244377564017974,0.04934980892317577,0.008904342022207048,0.010717992981274923,0.02088711162408193,0.016158666875627305,0.015379000041219924,0.0071172987421353655,0.0034005132814248404,0.0012095666800936062,0.0007443374229802026,8.238333329144452e-05,0.0,0.0,0.0,0.0,0.0,0.0017883856263425616,0.003852836787700653,0.027093332674768236,0.009192603329817453,0.00988126297791799,0.0,0.0,0.0,0.0,0.0),
(12.0,0.10148401527355115,0.09732171574917932,0.10478136343105386,0.10950375278480351,0.1058175197977107,0.051422918836275734,0.05001291632652283,0.05430650214354197,0.05704391499360403,0.05569233496983846,0.006946730737884839,0.003454434064527353,0.001497130064914624,0.0007453979148219029,8.523507858626544e-05,0.0007241111145251327,0.000194516666750941,0.0001454722239739365,0.0001083722195795013,0.00010036111214301652,0.007927060748140017,0.009815750022729238,0.012240500499804815,0.013386417180299759,0.0140822504957517,0.00014100554916593764,5.564999689037601e-05,2.9925001500588322e-05,1.046444473710532e-05,9.297221873162522e-06),
(15.0,0.1377121069158117,0.13041282929480075,0.14045626806716124,0.1423730446025729,0.14472815388192733,0.08154799938201904,0.07560866673787435,0.08360466957092286,0.08520600001017252,0.09357666969299316,0.0063625728090604145,0.0033649712800979613,0.001511350025733312,0.0007966006795565287,7.796032975117365e-05,0.0009150666495164236,0.00016920665899912516,0.00010961332979301612,6.453333189710974e-05,2.4416666322698197e-05,0.011217000087102254,0.013421600063641867,0.014769933621088664,0.015126599868138631,0.014159533381462096,5.8861332945525646e-05,7.67666691293319e-05,4.100200021639466e-05,1.3947333597267668e-05,3.5853333732423684e-06),
(20.0,0.20966551252640783,0.18653813432902097,0.1969648465514183,0.204606859292835,0.2087016277189832,0.1485599994659424,0.1287269949913025,0.13874449729919433,0.14566149711608886,0.15153100490570068,0.00597429983317852,0.003309580683708191,0.0013893820345401765,0.0007103525102138519,8.68607487063855e-05,0.0018942000344395638,0.0002609800081700087,0.0001488349982537329,6.399999838322402e-05,4.047049969813088e-07,0.007926549762487411,0.009539300203323364,0.011786799877882004,0.012652449309825897,0.014107349514961242,0.00016526499530300498,7.230999763123691e-05,3.9453001227229835e-05,1.4597999688703567e-05,9.798000064620283e-07),
(30.0,0.14992013961697617,0.12437674552202224,0.13058348961058072,0.13171869930017693,0.14180141432152596,0.07809942563374837,0.09449666341145833,0.09877633253733317,0.09923899968465169,0.10487600167592366,0.007541487614313762,0.0033217966556549072,0.0015485626955827078,0.0008521230270465215,9.208379779011012e-05,0.0005125666658083598,0.00020597333398958046,8.953333211441835e-05,1.4492333624123906e-06,8.97933326389951e-07,0.02727127472559611,0.006466233233610789,0.008923733234405517,0.009859899679819742,0.011603233218193055,0.00013358665940662226,6.396666479607423e-05,3.398333210498094e-05,1.1302332859486342e-05,2.7326665682873377e-06),
(40.0,0.090174765791744,0.13856801604852081,0.07745494707778562,0.08458799673244358,0.03709747227840125,0.007638850063085556,0.04130074977874756,0.05240499973297119,0.051527750492095944,0.020472049713134766,0.009108675271272659,0.004107600077986717,0.0015816057100892067,0.0008446107618510723,0.00010589887388050556,0.0010183749720454216,0.0003077999921515584,0.00014447499997913838,2.0923750707879662e-05,6.567000127688516e-07,0.04661599993705749,0.07100325226783752,0.007451225072145462,0.00835142508149147,0.008404800295829773,5.5892497766762975e-05,1.0776500130305066e-05,9.874499664874747e-06,9.19224985409528e-06,7.040250056888908e-06),
(60.0,0.08418047053273767,0.13384067194225888,0.20967545527964832,0.08352100538710754,0.013233610662670496,0.003236666570107142,0.03418416579564412,0.07581133047739665,0.05718309879302978,0.004677766561508178,0.014607750376065572,0.004526400069395701,0.00177088330189387,0.0009245071560144424,0.00011156571563333272,3.274144615229707e-05,8.471827942180786e-06,0.00018858642052073106,1.7784134617930855e-05,4.025328105397509e-07,0.04892983436584473,0.07739299933115641,0.12037683327992757,0.0066096569101015724,0.008438066641489664,5.5238360410392315e-05,1.076655001871612e-05,1.303692152624554e-05,7.370941677763837e-06,7.547148248979868e-06),
(100.0,0.053257497386075554,0.1628982514049858,0.23465712154342327,0.08138702630996704,0.16380431381054222,-0.004552200138568878,0.03238529920578003,0.07363377571105957,0.06849380016326904,0.13940500259399413,0.014824800491333008,0.005608590245246887,0.0022255943715572355,0.0010842999815940857,9.07829124480486e-05,0.0017289623239128459,5.346924947358216e-06,0.00010020171303017467,1.527244174597181e-05,5.5454669136654e-07,0.025742099285125733,0.10911700248718262,0.14974116325378417,0.0031261199712753294,0.007125290036201477,5.640127718874455e-05,1.1689964566437283e-05,1.5127992782105818e-05,5.913895136698682e-06,1.2390840368688705e-05),
(120.0,0.044097174242294084,0.1049294254432122,0.24714797067407895,0.001780442788246243,0.19424296412616968,-0.004357366760571798,0.018932499488194785,0.07254500389099121,-0.00026849759742617605,0.1595408280690511,0.014561416705449422,0.007227408389250438,0.002452949931224187,0.001687241718173027,0.0001134643331170082,0.00789541674732348,1.1036827723891195e-05,7.810553615753558e-05,1.2895604108244251e-05,5.350888934942685e-07,0.019637999931971233,0.0670579195022583,0.16442333857218425,0.00035913934310277305,0.016308666268984476,6.323338883091241e-05,1.1542696405982335e-05,1.5650760596070888e-05,8.731566105771305e-06,8.307494977607503e-06)])



yield_dict = {"LC18_R000": [LC18_R000_yields,[0.0134,0.00134,0.000134,0.0000134],["Z","O","N"]], "LC18_R150": [LC18_R150_yields,[0.0134,0.00134,0.000134,0.0000134],["Z","O","N"]], "LC18_R300": [LC18_R300_yields,[0.0134,0.00134,0.000134,0.0000134],["Z","O","N"]],\
"Nugrid":[Nugrid_yields,[0.02,0.01, 0.006, 0.001, 0.0001],["Z","O","N"]],"FRUITY":[FRUITY_yields,[0.02,0.014, 0.01,0.008, 0.006,0.003,0.002, 0.001,0.0003, 0.0001],["Z","O","N"]], "KA10": [KA10_yields,[0.02,0.008,0.004,0.0001],["Z","O","N"]],\
"KA18_high":[KA18_high_yields,[0.03,0.014,0.007,0.0028,0.001],["Z","O","N"]],"KA18_low":[KA18_low_yields,[0.03,0.014,0.007,0.0028,0.001],["Z","O","N"]],"VG97": [VG97_yields, [0.04,0.02,0.008,0.004,0.001],["Z","O","N"]], \
"MM02_000": [MM02_000_yields,[10**-5,0.004,0.02],["Z","O","N"]], "MA92_ori_extra": [MA92_yields_extra, [0.001,0.02],["Z","O","N"]], "Davis_AGB_yields": [Davis_AGB_yields, [0.02,0.008, 0.004, 0.0001],["Z","O","N","O18"]], "Davis_SN_yields": [Davis_SN_yields, [0.05,0.02,0.008, 0.004, 0.0004],["Z","O","N","O18"]],\
"Davis_AGB_yields_C": [Davis_AGB_yields_C, [0.02,0.008, 0.004, 0.0001],["Z","O","N","O18","C","C13"]], "Davis_SN_yields_C": [Davis_SN_yields_C, [0.05,0.02,0.008, 0.004, 0.0004],["Z","O","N","O18","C","C13"]]}


VG97_yields_tot = np.array([
(0.9,0.015559155555555555,0.007333318333333333,0.0030016337777777776,0.0014774667777777777,0.00042114222222222223,0.015475054444444443,0.007294633333333333,0.0029618336666666664,0.0014659447777777778,0.00042025222222222226,0.002100555423895518,0.0009983333279378712,0.0004029666626142959,0.00019556666943192893,5.595555288471385e-05),
(1.0,0.02521,0.012209998,0.0036320002,0.002574,0.00045915303,0.023909999,0.011580999,0.0035736002,0.0017836001,0.00045777005,0.0030685000117123126,0.0015149999669753014,0.0004869600002188236,0.0002302100000893697,6.260000105306972e-05),
(1.3,0.02124656923076923,0.011820923846153845,0.005894615692307692,0.004020769615384615,0.003620769230769231,0.02112376923076923,0.011492923846153845,0.004332615769230769,0.0021737693846153846,0.0007797692307692307,0.003020999941917566,0.0016423846212430641,0.0006003999752579973,0.0002853999919859835,7.425384476082399e-05),
(1.5,0.025313666666666665,0.015013333333333332,0.007966667333333333,0.00505,0.004123333333333334,0.025089465333333335,0.013304334000000001,0.005122667333333333,0.002687,0.0008773333333333333,0.0035978665951887766,0.00189133341734608,0.0006988533339550097,0.00035113999544829133,8.393333052750676e-05),
(1.7,0.027609823529411763,0.01578176411764706,0.008780588235294118,0.006625294117647059,0.004393529588235294,0.027259820588235294,0.013589763529411764,0.005519588235294118,0.002944294117647059,0.0009275294117647058,0.003970882300857235,0.001958823546219398,0.0007622823757568704,0.000377729406063171,8.954705843866309e-05),
(2.0,0.03,0.01794,0.01099,0.0086199995,0.0059499995,0.028287798,0.0140777,0.0058140005,0.003121,0.00106,0.004181349911689758,0.0022499999912455678,0.0009645050163753331,0.0005074300043582916,0.00012730000091483817),
(2.5,0.0339,0.0207999988,0.012564,0.009796000000000001,0.006293999999999999,0.030320200000000002,0.0151580988,0.006219000000000001,0.003372,0.00113300012,0.0046771998766064644,0.0026039999783039093,0.0011511319945544005,0.0006017680177748204,0.00013748000194318592),
(3.0,0.037156666666666664,0.022786666666666667,0.014273333333333332,0.01155,0.006076666666666667,0.031963066666666665,0.015865196666666668,0.006598333333333334,0.0036320003333333334,0.0011436666666666667,0.005137766521374384,0.002840666699409485,0.0012237466408958038,0.0006366599977239967,0.0001310666677262634),
(4.0,0.04059,0.02228999875,0.01164,0.00896,0.0073325,0.0327829975,0.015834,0.0062572,0.003366,0.0012035,0.005350099940896034,0.002943500018306076,0.004863225191265344,0.004660807538211346,0.0047740750829875465),
(5.0,0.042510002000000005,0.022599998,0.013038,0.010286,0.0085240006,0.03325,0.0160289988,0.0065140008,0.0034730002000000005,0.001216,0.005679620057702064,0.008432399702072144,0.006880554090213775,0.006588588133764267,0.0066262802011966705),
(7.0,0.04285,0.024682855714285714,0.01508142857142857,0.012240000000000001,0.010448571428571429,0.03314999857142857,0.015662856428571428,0.006099429000000001,0.003106000142857143,0.0009014714285714285,0.013724199446610044,0.010945999777317047,0.009280358256612506,0.008787480276857104,0.008748699579238892),
(8.0,0.0437899975,0.02553499875,0.01701,0.012975,0.0095512495,0.03325,0.01552499925,0.005818,0.00308400025,0.00086725,0.014533462809026242,0.01199875026345253,0.011575848516523837,0.009600259002149105,0.00799398742377758)])

KA10_yields_tot = np.array([
(1.0,0.008308610407670003,0.003220582105580001,0.0014850859035000006,0.00029433876637041006,0.0042010500000000004,0.0016244799999999998,0.0007461849999999999,2.49041e-05,0.00066339,0.000272524,0.000136231,5.57638e-06),
(1.25,0.010327914201500806,0.0039715094533599995,0.0020029428991408006,0.0031666366260520995,0.005205088,0.0019973519999999995,0.00093864,9.850824e-05,0.0010014800000000001,0.00041254560000000004,0.0002034464,1.841136e-05),
(1.5,0.01147350337017,0.004589833000570667,0.003496573356100677,0.008357536871009284,0.005775300000000001,0.002220113333333333,0.0011369133333333332,0.00021093139999999998,0.00125476,0.000517862,0.000264922,2.969393333333333e-05),
(1.75,0.012418695946466857,0.006647803610113183,0.005798676480624674,0.014765990483484766,0.006247314285714286,0.002467262857142857,0.0012980514285714285,0.0002736552571428572,0.0014357771428571428,0.00060624,0.0003168365714285714,3.4028057142857144e-05),
(1.9,0.012803579963336323,0.007905195056973824,0.007450977140626839,0.017812507873934038,0.006442684210526317,0.002586389473684211,0.0013508315789473686,0.0002831285789473684,0.001480463157894737,0.0006268736842105264,0.00033500052631578946,3.738905263157895e-05),
(2.0,0.012992534268143506,0.010410313836646904,0.008614247096231775,0.020642072095045476,0.00652355,0.002691428571428571,0.0014076285714285713,0.0002900055,0.00151154,0.0006767619047619047,0.0003264842857142857,3.906265e-05),
(2.25,0.013992892845463123,0.01239231086226232,0.013936151837830736,0.02543562946222616,0.006745644444444445,0.002749022222222222,0.0014461066666666665,0.0003135523111111111,0.0016416,0.0006939333333333334,0.0003562804444444444,3.618448888888889e-05),
(2.5,0.016454193696828347,0.014718342460030722,0.01809350159603826,0.022598971084890153,0.00691212,0.0027461200000000003,0.001444624,0.000310664,0.0017256799999999998,0.000760596,0.0003954708,2.33248e-05),
(3.0,0.0205418933466884,0.01990789142443007,0.016942789060029422,0.008595001549349475,0.007064133333333333,0.0027656666666666667,0.0014582466666666666,0.00017413360000000002,0.00188836,0.0008238933333333334,0.000406917,2.9268106666666668e-05),
(3.5,0.021912794051591834,0.014040219417492065,0.010211400911955893,0.007755129163536973,0.007171971428571429,0.002855085714285714,0.0015042085714285715,0.0001653963657142857,0.002033051428571429,0.0008633828571428571,0.000471443,0.0051715214285714284),
(4.0,0.018722591111488288,0.011232344453188887,0.011346708961651925,0.008459309542712823,0.007302525000000001,0.0029352000000000002,0.0015197655,0.00020006361499999998,0.002159095,0.00087254525,0.0059251057499999996,0.0065751375),
(4.5,0.018531173106061262,0.01516094814906751,0.01428801283297857,0.0061549520340692864,0.007291311111111111,0.0028719184444444446,0.0013583368888888888,0.00014472981777777775,0.002333487555555556,0.008489045333333332,0.010177965333333334,0.004977896666666667),
(5.0,0.01852681669140016,0.01677582862232071,0.016929565420063027,0.005737342564838995,0.0071911768,0.002405328,0.0010245229999999998,0.00012211047799999997,0.0032800704000000005,0.011080216,0.013120272000000002,0.0048201384),
(5.5,0.020224288410346073,0.014448826091877379,0.012180303976020834,0.005909695041307001,0.006960768909090909,0.002405944909090909,0.0010173525454545455,0.00010764219636363637,0.0071092358181818185,0.008727456363636364,0.00883656909090909,0.005091081636363637),
(6.0,0.03823230750105235,0.013164188390035449,0.011655209365715537,0.01314478532690063,0.013512585628205127,0.0019391694999999997,0.0006405551666666667,0.0002571455053333333,0.013536210269230771,0.008316871666666666,0.009000258333333332,0.011900834999999998)])

FRUITY_yields_tot= np.array([
(1.3,0.010646846833220758,0.007538089025016307,0.005322546855027789,0.004301818753583419,0.0037301161123903296,0.0024509502673035763,0.002695720730547809,0.0022746834620470213,0.002576354952195416,0.002576354952195416,0.004657380307692307,0.0032965632307692307,0.002287955769230769,0.0018155337692307692,0.001383894615384615,0.0006929636153846153,0.000497301076923077,0.00026985212307692306,0.00027401633076923077,0.00027401633076923077,0.0010629966923076924,0.0007741276923076923,0.0005525965307692308,0.00044758118461538457,0.00034561472307692305,0.00017978092307692307,0.00012571531538461538,6.671657538461538e-05,2.8364482307692308e-05,2.8364482307692308e-05),
(1.5,0.012690026988653064,0.009390155505964944,0.0075146807855707674,0.006106317722418754,0.005711743105510443,0.004095083776699219,0.004573341545301782,0.004111887839882837,0.00477329511309636,0.00477329511309636,0.005089410066666667,0.0035754712000000007,0.002640112866666667,0.002058633066666667,0.0015766006000000003,0.0008118883333333332,0.0005930250666666667,0.00034322004666666666,0.00035179736666666664,0.00035179736666666664,0.0012678912666666666,0.0008988916666666666,0.0006737335333333334,0.0005396322066666667,0.0004055803466666667,0.00020930531333333334,0.00014618842666666666,7.763057133333333e-05,3.4557858e-05,3.4557858e-05),
(2.0,0.017492047121562257,0.012983622808237734,0.011305589579479525,0.00956946059048414,0.009280740198608028,0.007756387880138012,0.008152456625964085,0.007285315120841203,0.0076168952926264225,0.0076168952926264225,0.00600382,0.004151164000000001,0.0030587734500000002,0.0024059960999999997,0.0018924564,0.001017175,0.0007415614499999999,0.000434322435,0.00042395267000000004,0.00042395267000000004,0.0016289450000000001,0.00114421205,0.00084738415,0.0006827622,0.000526197285,0.00027586964,0.000190513835,0.00010151698,4.2104533e-05,4.2104533e-05),
(2.5,0.020942965706691158,0.01565381857005447,0.013995097503003932,0.012451660902283654,0.011580459183033829,0.007656056418349037,0.006944372834166164,0.005939351063744255,0.004783541457291405,0.004783541457291405,0.006343696,0.0043835988,0.0032343083999999992,0.00259336804,0.0019890615600000002,0.00102820676,0.00072009532,0.00041452419999999995,0.00038250411199999997,0.00038250411199999997,0.00195386764,0.00140437572,0.0010429707999999999,0.00085640736,0.000654431824,0.000339171544,0.00022475822000000002,0.00010959412400000001,3.66051192e-05,3.66051192e-05),
(3.0,0.02049066010121198,0.015117737817972614,0.011833924057780372,0.00984465683639698,0.007583870741186854,0.004472399264494453,0.004133853422228994,0.0033864312363424427,0.0031122957650125023,0.0031122957650125023,0.006385662,0.004469436,0.0032754486666666666,0.002598066333333333,0.0019509264666666666,0.0009988474666666667,0.0007012976666666667,0.0003765746666666667,0.00035761471999999996,0.00035761471999999996,0.0021388081666666664,0.001569348866666667,0.0011741664999999999,0.0009540602,0.0007122961333333334,0.00034264701666666665,0.00021771414666666667,0.00010681013,3.889759233333333e-05,3.889759233333333e-05),
(4.0,0.01698171836700267,0.01153546805447959,0.008544057159194218,0.0069492803381198546,0.0057615773558233226,0.0034445800400397897,0.003107751311175283,0.0022841113473844087,0.002795668103292183,0.002795668103292183,0.00672286475,0.00454571675,0.0032668605,0.0026144170000000004,0.0019866165000000002,0.000996240425,0.0006733124750000001,0.00035095187500000004,0.0003477078975,0.0003477078975,0.002403874975,0.0016902465,0.0012577262,0.001003686575,0.000737986325,0.000374734055,0.0002596581425,0.00014052826999999999,6.3696771e-05,6.3696771e-05),
(5.0,0.016881954994573404,0.011742145565275022,0.008671090343459545,0.007147779512026836,0.0054576361110062095,0.0033273378101146126,0.002899314628690246,0.0021190425891758906,0.00245291719015502,0.00245291719015502,0.0065765236,0.004503861,0.0032798072000000005,0.0026234378,0.0019509922,0.00097168598,0.0006593513200000001,0.00034525961999999996,0.00034087308999999997,0.00034087308999999997,0.00285290794,0.00199813774,0.0014135221,0.00114382498,0.0008763666200000001,0.00045989837800000004,0.000314807018,0.000167601724,8.7968211e-05,8.7968211e-05),
(6.0,0.017155305176176756,0.011905931466363928,0.008835269932496982,0.007111346109630749,0.005438404879429368,0.003109990853189475,0.0023533758695007535,0.0018595779892873552,0.0015844725491121932,0.0015844725491121932,0.0064551225,0.004441136833333334,0.003224944,0.002554260166666667,0.001912916166666667,0.0009908459,0.0006464243166666667,0.0003352417833333333,0.00031350986833333336,0.00031350986833333336,0.00319514925,0.0021991614,0.0015809418666666668,0.00127337555,0.0009821497333333334,0.0005382537666666667,0.00036795520833333333,0.00032856787500000007,0.00021919547633333336,0.00021919547633333336)])

KA18_low_yields_tot= np.array([
(1.0,0.012267152717969597,0.0059224800538473,0.0028131113416939003,4.6927323506900005e-06,0.0003248844389864419,0.00524461,0.00251199,0.00118895,-5.70281e-06,0.0001397754,0.00096258,0.000474836,0.000241779,4.44708e-05,1.687969e-05),
(1.25,0.015210957604633596,0.007384852885457283,0.003557459390794881,0.0010713663417421602,0.0004692393708147464,0.0064909040000000005,0.0031260240000000003,0.001502656,5.4702560000000004e-05,0.00020188136000000003,0.001468568,0.0007291408,0.0003694848,8.25592e-05,2.4379784e-05),
(1.5,0.017179044531257997,0.008307618800160873,0.004243363545403331,0.0021811433916816662,0.0005555251932084218,0.0073196,0.0035097600000000002,0.0017125266666666668,7.695733333333334e-05,0.0002390042,0.0018485333333333335,0.0009304933333333333,0.0004603393333333333,0.00011867333333333334,2.8862846666666666e-05),
(1.75,0.01857259989005713,0.008981614269188578,0.005926486135662288,0.004269862188317143,0.0,0.0079036,0.00378972,0.001915537142857143,0.0001539697142857143,0.0,0.00214756,0.0010671142857142859,0.0005436628571428571,0.000143996,0.0),
(2.0,0.019575770252988504,0.01238286488151899,0.007281440613364999,0.007334530105492998,0.000653578871620653,0.0083455,0.004072705,0.0019884,0.0001861315,0.0002811899,0.00202671,0.00111671,0.000552835,0.000162804,3.3957325e-05),
(2.25,0.020370121255328444,0.01308176427845778,0.010666342621280002,0.009500257127395557,0.0006843541256620039,0.008684711111111111,0.004257288888888888,0.0022817555555555554,0.00024549244444444445,0.00029443039999999996,0.0020805733333333336,0.0011876222222222221,0.0006357377777777778,0.00019157733333333333,3.555628444444444e-05),
(2.5,0.021026264401137994,0.014801183535344,0.012644659123923997,0.011198477616423999,0.000699328198934408,0.00879932,0.0043648,0.002308396,0.0002137968,0.00030087272000000004,0.002475212,0.001345112,0.000738776,0.0002297328,3.6334276e-05),
(2.75,0.022595505410951268,0.01675055946548727,0.01498124521484364,0.010805424635687271,0.0007115127403718693,0.008962872727272727,0.004437018181818182,0.0023271563636363636,0.00019356,0.00030611487272727274,0.002737941818181818,0.0014402836363636361,0.0007763018181818182,0.00019680036363636366,3.6967345454545456e-05),
(3.0,0.024990476074426664,0.017984278748716675,0.015135485865169999,0.008873763276300002,0.00071832951871181,0.0090706,0.0043704,0.0022752533333333332,0.00012522566666666666,0.00030904766666666665,0.0028550366666666668,0.00155671,0.0008151166666666667,0.00021555299999999997,3.73215e-05),
(3.25,0.027663553632129224,0.01910581876968614,0.01422638783088,0.0066199904903753845,0.0007229975700909933,0.009121846153846154,0.004447076923076923,0.0022897846153846152,0.00012298584615384617,0.000311056,0.0029007538461538465,0.0016314861538461538,0.00084076,0.00020283384615384616,3.7564030769230766e-05),
(3.5,0.02973840877918858,0.018576934423997132,0.013188534109562852,0.005544829490461714,0.0007371705367454712,0.009123314285714284,0.004529171428571429,0.0023358371428571427,0.0001245897142857143,0.0003171537142857143,0.0030756,0.0016337771428571429,0.0008363171428571429,0.00024534857142857145,3.83004e-05),
(3.75,0.030140307433501334,0.017858065206895996,0.011940371395016,0.005162261192863735,0.0,0.009237546666666667,0.004542346666666667,0.00238916,3.3918133333333337e-05,0.0,0.0030956800000000004,0.0017090719999999998,0.0008071199999999999,0.000575608,0.0),
(4.0,0.0279716552256225,0.016447610476349,0.010772129524996999,0.004633229119654497,0.0007606591909540877,0.009310275,0.00453865,0.00233243,9.997875e-06,0.00032725925,0.003316925,0.001695295,0.0008497125,0.000408575,3.9520775e-05),
(4.5,0.025541693878299108,0.01724460073650734,0.016372576515065344,0.004898233165211754,0.0007791685251468182,0.009449977777777778,0.004559555555555556,0.002111577777777778,-7.756155555555556e-05,0.00033522244444444445,0.0033411555555555557,0.005098022222222222,0.010748155555555555,0.0042412,4.0482466666666664e-05),
(5.0,0.026466817356199008,0.018064214615466187,0.015404777479219606,0.010846228850498364,0.0007930051109880298,0.00931462,0.0044281599999999996,0.0017297139999999998,-0.00054835,0.0003411754,0.0038189,0.0078003199999999995,0.01015868,0.01055404,4.120136e-05),
(5.5,0.026862152739561437,0.01805895047932453,0.01377147067534491,0.003038705873061374,0.000803697081317218,0.009245509090909092,0.004073363636363636,0.0014431363636363637,-0.0004131581818181818,0.00034577545454545454,0.0052586,0.008400727272727273,0.00917269090909091,0.0034195818181818184,4.1756854545454545e-05),
(6.0,0.027261975063643324,0.017177357490225156,0.010865873129382326,0.0021091637035311407,0.0008109723284793164,0.009165283333333333,0.00373655,0.0012667516666666667,-0.0005333983333333333,0.0003489055,0.0073169,0.007999433333333333,0.0066894833333333336,0.0027592333333333334,4.213485e-05),
(7.0,0.026955540028921438,0.015136314565501716,0.008066726330224294,0.0008651616872986034,0.000816551518066608,0.008862057142857144,0.0035205285714285718,0.001368242857142857,-0.0006493157142857143,0.0003513058571428572,0.008396442857142857,0.006584171428571428,0.004066514285714286,0.0017262142857142858,4.242472857142857e-05)])

KA18_high_yields_tot= np.array([
(1.0,0.012267152717969597,0.0059224800538473,0.0028131113416939003,4.6927323506900005e-06,0.0003248844389864419,0.00524461,0.00251199,0.00118895,-5.70281e-06,0.0001397754,0.00096258,0.000474836,0.000241779,4.44708e-05,1.687969e-05),
(1.25,0.015210957604633596,0.007384852885457283,0.003557459390794881,0.0011216877088984795,0.0004692393708147464,0.0064909040000000005,0.0031260240000000003,0.001502656,8.08136e-05,0.00020188136000000003,0.001468568,0.0007291408,0.0003694848,8.1852e-05,2.4379784e-05),
(1.5,0.017179044531257997,0.010518304881136668,0.005294819195682667,0.0022043657100772,0.0005555251932084218,0.0073196,0.0036715800000000002,0.00178586,0.000137732,0.0002390042,0.0018485333333333335,0.0009491399999999999,0.00046484,0.00011755666666666668,2.8862846666666666e-05),
(1.75,0.01857259989005713,0.011506736769692568,0.007584878843530286,0.004269862188317143,0.0,0.0079036,0.003951171428571429,0.00205188,0.0001539697142857143,0.0,0.00214756,0.0010804057142857143,0.000552564,0.000143996,0.0),
(2.0,0.019575770252988504,0.012444535290380003,0.011999635448940007,0.007470092370404999,0.000653578871620653,0.0083455,0.004143065,0.002566975,0.000351816,0.0002811899,0.00202671,0.001116975,0.000715205,0.0001597435,3.3957325e-05),
(2.25,0.020370121255328444,0.01308176427845778,0.014049621248804446,0.009500257127395557,0.0006843541256620039,0.008684711111111111,0.004257288888888888,0.0025648844444444447,0.00024549244444444445,0.00029443039999999996,0.0020805733333333336,0.0011876222222222221,0.0008208622222222223,0.00019157733333333333,3.555628444444444e-05),
(2.5,0.027388223172532,0.014801183535344,0.016479369736327992,0.0112894599578328,0.000699328198934408,0.00901708,0.0043648,0.002559872,0.00030484319999999997,0.00030087272000000004,0.002341284,0.001345112,0.000853932,0.00023129359999999997,3.6334276e-05),
(2.75,0.027849628814690896,0.01675055946548727,0.016550910843465452,0.010805424635687271,0.0007115127403718693,0.00900850909090909,0.004437018181818182,0.0025396399999999997,0.00019356,0.00030611487272727274,0.0027110181818181815,0.0014402836363636361,0.0008889709090909091,0.00019680036363636366,3.6967345454545456e-05),
(3.0,0.027506526095759994,0.01807084317679,0.015411920150120004,0.00891838803301333,0.00071832951871181,0.009069966666666667,0.0044631666666666665,0.0024806,0.00018348433333333333,0.00030904766666666665,0.0028466933333333336,0.0015562766666666666,0.0009108233333333333,0.00022898666666666667,3.73215e-05),
(3.25,0.027663553632129224,0.019132355343363057,0.014203036733375382,0.0066199904903753845,0.0007229975700909933,0.009121846153846154,0.004492615384615385,0.002515516923076923,0.00012298584615384617,0.000311056,0.0029007538461538465,0.0016313446153846155,0.0009006492307692308,0.00020283384615384616,3.7564030769230766e-05),
(3.5,0.02973840877918858,0.018576934423997132,0.012793255066088562,0.005544829490461714,0.0007371705367454712,0.009123314285714284,0.004529171428571429,0.0025598142857142857,0.0001245897142857143,0.0003171537142857143,0.0030756,0.0016337771428571429,0.0008647714285714285,0.00024534857142857145,3.83004e-05),
(3.75,0.030140307433501334,0.017858065206895996,0.011545057285874669,0.004321136006754669,0.0,0.009237546666666667,0.004542346666666667,0.002562021333333333,8.66008e-05,0.0,0.0030956800000000004,0.0017090719999999998,0.0009068266666666668,0.0002567936,0.0),
(4.0,0.0279716552256225,0.016495068667445007,0.01827826320721501,0.004688164201981503,0.0007606591909540877,0.009310275,0.004592025,0.002365085,8.7747e-05,0.00032725925,0.003316925,0.001697595,0.0119717,0.00039487,3.9520775e-05),
(4.5,0.025565635952853327,0.017263890180375552,0.01711641942135511,0.004901175033481111,0.0007791685251468182,0.009480088888888889,0.0046455333333333335,0.0019219044444444442,-7.075777777777777e-05,0.00033522244444444445,0.003344,0.004823733333333333,0.011287422222222223,0.004233155555555555,4.0482466666666664e-05),
(5.0,0.026466636284791796,0.018066800173900593,0.015148617742879412,0.003969949284955728,0.0007930051109880298,0.00931766,0.00443592,0.00158745,-0.00023557,0.0003411754,0.00382066,0.00779418,0.01008996,0.0039042800000000004,4.120136e-05),
(5.5,0.026862152739561437,0.01805895047932453,0.011853679777507994,0.003038705873061374,0.000803697081317218,0.009245509090909092,0.004073363636363636,0.0013819109090909092,-0.0004131581818181818,0.00034577545454545454,0.0052586,0.008400727272727273,0.0072976181818181825,0.0034195818181818184,4.1756854545454545e-05),
(6.0,0.027261975063643324,0.017177357490225156,0.00941118071859501,0.0021091637035311407,0.0008109723284793164,0.009165283333333333,0.00373655,0.0015962833333333334,-0.0005333983333333333,0.0003489055,0.0073169,0.007999433333333333,0.004744266666666667,0.0027592333333333334,4.213485e-05),
(7.0,0.026955540028921438,0.015136314565501716,0.0,0.0007360639928755712,0.000816551518066608,0.008862057142857144,0.0035205285714285718,0.0,-0.0005955471428571429,0.0003513058571428572,0.008396442857142857,0.006584171428571428,0.0,0.001600857142857143,4.242472857142857e-05)])

Nugrid_yields_tot= np.array([
(1.0,0.008827591685229999,0.004493204657830001,0.0026022951553109994,0.0013606878205461,0.010638983974533998,0.004243,0.002127,0.001921,0.0005767,0.001835,0.0006713,0.0003519,8.937e-05,1.985e-05,7.763e-05),
(1.65,0.013967950868139394,0.00903372967258788,0.01015457265026061,0.012064996314401815,0.01884703200966576,0.006066666666666667,0.003580606060606061,0.004637575757575758,0.003598181818181818,0.005227878787878788,0.0014109090909090911,0.0007563636363636364,0.0002464848484848485,6.278787878787879e-05,3.460606060606061e-05),
(2.0,0.025418004667854998,0.019633753428184998,0.016895869657344995,0.0197676276248855,0.017283384828706658,0.009555,0.006945,0.00665,0.00592,0.004976,0.0017805,0.0009655,0.0003924,8.555e-05,1.935e-05),
(3.0,0.03330052340735334,0.021471586230606663,0.012788870818846663,0.004453358580984666,0.003954878783368135,0.012013333333333334,0.0074399999999999996,0.005256666666666666,0.0013413333333333333,0.000927,0.002391,0.0012723333333333334,0.0005646666666666667,7.376666666666667e-05,1.136e-05),
(4.0,0.0251601577845,0.013898846784149998,0.0073910562399700005,0.0047118993862125,0.004162449263667749,0.00961,0.004955,0.003755,0.00157,0.00102,0.0026025,0.0014595,0.0007135,0.001953,0.0025475),
(5.0,0.020913300139788007,0.011459046086700002,0.005117390672761999,0.0018640920012340002,0.00115014365637652,0.007846,0.003994,0.002852,0.0002434,3.6660000000000005e-05,0.003356,0.003118,0.0014878,0.0012645999999999998,0.0009384),
(6.0,0.018477525917766666,0.011298752870850002,0.005650876837995,0.0012476515012376668,0.0004970469634835502,0.006331666666666667,0.003238333333333333,0.00235,0.00020866666666666668,3.731666666666667e-05,0.006853333333333333,0.0049566666666666665,0.0024216666666666666,0.0008583333333333333,0.00039333333333333337),
(7.0,0.018189765346000003,0.01018060171627143,0.005532583741527143,0.0019763595176442855,0.0018956018644720003,0.006019999999999999,0.002621428571428572,0.002214285714285714,0.0005365714285714286,0.00046414285714285714,0.0067800000000000004,0.004501428571428572,0.0024271428571428573,0.0011317142857142858,0.0011454285714285715),
(12.0,0.05309766510483082,0.05560025455697334,0.06593995761091491,0.07147316475544299,0.07561387328717492,0.010858333333333333,0.010658333333333334,0.0171,0.0222,0.021316666666666668,0.003608333333333333,0.0017833333333333332,0.0010191666666666667,0.00017116666666666666,1.805e-05),
(15.0,0.12050286916048135,0.121244520359092,0.12340643512886901,0.13263467912960197,0.12426822418585222,0.05468,0.05058666666666667,0.050513333333333334,0.06813333333333334,0.05926,0.003332,0.0017433333333333333,0.00097,0.00017853333333333333,2.0333333333333334e-05),
(20.0,0.12736678138423996,0.18281369645987303,0.18032693026172592,0.18422180904831897,0.1861856326222084,0.078,0.0911,0.08205,0.09755,0.11605000000000001,0.003469,0.001768,0.0011085,0.00020040000000000002,0.0010865),
(25.0,0.0097132097456064,0.0060126961714668,0.008124603978232003,0.0678419522975512,0.07477247210509354,0.0036956,0.0017856,0.0018948,0.04604,0.05248,0.0020216,0.0019412,0.0013196,0.00023391999999999998,0.0010808)])

LC18_R000_yields_tot = np.array([
(13.0,0.0519170638980376,0.05060349325302443,0.04832626273291046,0.0501811712431424,0.019005384615384615,0.021541538461538463,0.021028461538461538,0.022343846153846155,0.0025463076923076923,0.0005917153846153846,6.552307692307692e-05,7.835384615384616e-06),
(15.0,0.08766075123234718,0.10006991626601498,0.07412708556558653,0.09560140780070783,0.03904866666666666,0.057263999999999995,0.03728,0.053975333333333333,0.002442533333333333,0.0005392266666666667,6.493866666666666e-05,6.992e-06),
(20.0,0.13032945216817127,0.1299872549044597,0.12937894106223757,0.13170167543473685,0.06282,0.0668,0.068135,0.070955,0.00218785,0.0005448,5.934999999999999e-05,6.8004999999999995e-06),
(25.0,0.1825819557975623,0.1727092467771084,0.16546017799609403,0.17089456970269046,0.09905599999999999,0.10810399999999999,0.095028,0.10458,0.0023758399999999997,0.00050416,6.5764e-05,6.7152e-06),
(30.0,0.008552539624411003,0.00018593190820925673,1.4896432176976672e-06,2.1656192187393338e-08,0.0024656333333333332,0.00011762666666666667,9.424e-07,1.3699666666666666e-08,0.002260166666666667,4.003666666666667e-06,3.207633333333333e-08,4.663e-10),
(40.0,0.008623913142570752,0.0009059142833053252,2.04218378980475e-06,2.5857291326922502e-08,0.0021869,0.000501375,1.29195e-06,1.635725e-08,0.00261425,0.00010840750000000002,4.3975e-08,5.5675e-10),
(60.0,0.016173451657845332,0.0009571223514574173,2.062665665686334e-06,3.0882645507193325e-08,0.002489666666666667,0.00044211666666666663,1.3049166666666665e-06,1.9536666666666666e-08,0.0034596666666666664,0.00022050000000000002,4.4415000000000004e-08,6.649500000000001e-10),
(80.0,0.02455372186679275,0.0015781895092068128,5.67208766041e-06,4.0017878171775e-08,0.0030280000000000003,0.0005042874999999999,3.588375e-06,2.5315000000000002e-08,0.003569875,0.0006225,1.2213875e-07,8.61675e-10),
(120.0,0.028449316895589917,0.004778678977156023,4.598539769004498e-05,9.202545427717501e-08,0.0030716666666666666,0.0014558333333333333,2.4914999999999998e-05,5.8215e-08,0.004146083333333333,0.0008805833333333334,6.0021666666666665e-06,1.9815e-09)])


LC18_R150_yields_tot = np.array([
(13.0,0.15992809614156378,0.16948569544269837,0.1701003404788749,0.15842968060331453,0.1011,0.09698461538461538,0.11381538461538462,0.11225384615384616,0.0030222307692307692,0.0054210769230769226,0.004647615384615385,0.0025877692307692307),
(15.0,0.20197637744237767,0.19288401999840607,0.190174992486632,0.1968262799663349,0.12841333333333332,0.1274,0.11087333333333334,0.13416666666666668,0.0027385333333333336,0.006407466666666667,0.0046743999999999996,0.0011802),
(20.0,0.22381754756153505,0.23948746454772848,0.21720461948829137,0.21420004533073905,0.130905,0.167845,0.1553,0.1563,0.00340055,0.0068435,0.005049,0.0026494500000000002),
(25.0,0.2518280267364544,0.2777598213969081,0.2597366415308304,0.25832514855300837,0.14568,0.19625599999999999,0.18558,0.188208,0.0034431600000000002,0.00340728,0.00033133999999999995,0.0034633999999999997),
(30.0,0.020529649515639063,0.0004342175273782986,3.457673392234553e-05,5.522496219547379e-06,0.003483666666666667,0.00017319333333333335,1.2966333333333333e-05,1.4746e-06,0.0035783333333333335,0.00013628333333333333,1.3402333333333332e-05,3.1714000000000002e-06),
(40.0,0.02359377630235279,0.0014630405406138851,0.0009484983338227917,1.2400411427490436e-05,0.0034507500000000003,0.000333025,0.0001829375,5.3105e-06,0.0040345,0.000776175,0.000429575,4.258999999999999e-06),
(60.0,0.03049730223153058,0.020733806275891786,0.0016061354039198308,9.682868765873944e-06,0.0038131666666666665,0.0026596666666666665,0.00044348333333333337,4.0645e-06,0.004033833333333333,0.0007950333333333334,0.000473,3.346e-06),
(80.0,0.03426483381765992,0.028547807631294653,0.002989139684627477,1.0490691052851825e-05,0.0043802500000000005,0.0042647499999999994,0.00088045,3.76925e-06,0.004182875,0.00072565,0.0005415750000000001,4.205500000000001e-06),
(120.0,0.029208310122736066,0.020069059494207384,0.007006934269079795,1.7505347925612494e-05,0.00288175,0.0024173333333333334,0.0020054166666666666,2.7479166666666667e-06,0.004758833333333334,0.0010163333333333333,0.0005168916666666666,1.1662499999999999e-05)])

LC18_R300_yields_tot = np.array([
(13.0,0.19910603436231092,0.20674697723771204,0.2097757357661211,0.19596937748917845,0.11473846153846154,0.10362307692307691,0.10043846153846155,0.12038461538461538,0.004033923076923077,0.004074153846153846,0.005401923076923077,0.010510769230769232),
(15.0,0.2342196144233373,0.23440060684937744,0.21796832991749118,0.20748079181145765,0.12807333333333334,0.11869333333333333,0.11223999999999999,0.12584666666666666,0.004900066666666666,0.004626466666666666,0.004399533333333333,0.010199999999999999),
(20.0,0.24499781637826687,0.23341064447491133,0.24793863205367536,0.21183642093476981,0.147535,0.16275,0.187405,0.14802500000000002,0.0066170000000000005,0.00297995,0.0008625499999999999,0.0007267),
(25.0,0.2724330304937035,0.3251918725569156,0.33753219655800026,0.33615851927292356,0.156048,0.225096,0.23783200000000002,0.23715599999999998,0.0041868,0.0022586800000000003,0.0005074,0.0007897999999999999),
(30.0,0.02407004626479433,0.001798267822802459,0.0020059927503397017,1.3824437999470113e-05,0.0032772,0.0004608,0.00027489666666666665,5.184e-06,0.004387,0.0009815666666666667,0.0005054333333333333,5.623333333333333e-06),
(40.0,0.028036607483691727,0.006959682948025379,0.0027773901936808234,1.247545773523433e-05,0.00329475,0.0019057000000000002,0.000543775,5.0127499999999996e-06,0.004371,0.00223075,0.001231625,4.7435e-06),
(60.0,0.0253756617613368,0.024407026392810605,0.006886485153993681,1.1664514770100807e-05,0.0021266666666666665,0.003415,0.0013717166666666668,4.243000000000001e-06,0.004730333333333334,0.0010012999999999999,0.0012727166666666667,4.856666666666666e-06),
(80.0,0.022626617521481304,0.02257452351358602,0.008883537107882757,0.00036675188656823144,0.0017319999999999998,0.002886625,0.001637875,7.259625e-05,0.005425625,0.0008370125000000001,0.0007875250000000001,0.0002674375),
(120.0,0.020769682932169922,0.02056276441969962,0.013497182739306142,1.4329268764949266e-05,0.0013664166666666666,0.002544666666666667,0.00264875,2.2243333333333334e-06,0.006205416666666667,0.0010365,0.00050285,9.740833333333333e-06)])

yield_tot_dict = {"LC18_R000": [LC18_R000_yields_tot,[0.0134,0.00134,0.000134,0.0000134],["Z","O","N"]], "LC18_R150": [LC18_R150_yields_tot,[0.0134,0.00134,0.000134,0.0000134],["Z","O","N"]], "LC18_R300": [LC18_R300_yields_tot,[0.0134,0.00134,0.000134,0.0000134],["Z","O","N"]],\
"Nugrid":[Nugrid_yields_tot,[0.02,0.01, 0.006, 0.001, 0.0001],["Z","O","N"]],"FRUITY":[FRUITY_yields_tot,[0.02,0.014, 0.01,0.008, 0.006,0.003,0.002, 0.001,0.0003, 0.0001],["Z","O","N"]], "KA10": [KA10_yields_tot,[0.02,0.008,0.004,0.0001],["Z","O","N"]],\
"KA18_high":[KA18_high_yields_tot,[0.03,0.014,0.007,0.0028,0.001],["Z","O","N"]],"KA18_low":[KA18_low_yields_tot,[0.03,0.014,0.007,0.0028,0.001],["Z","O","N"]],"VG97": [VG97_yields_tot, [0.04,0.02,0.008,0.004,0.001],["Z","O","N"]]}


'''
The following tables give the mass loading factors from Nelson et al (2019, MNRAS 490 3234) at different redshifts (seperate tables) and different stellar masses (first column in the table).
The second, third and fourth column give the mass loading factors for the outflow component with v_out<150 km/s, 150 km/s<vout<250 km/s, and vout>300 km/s respectively.
These seperate components are tracked separately in terms of their recycling.
'''
print('Using median eta tables')
# Nelson+ (2019) http://arxiv.org/abs/1902.05554
# Figure 5 Mass Loading vs. Stellar Mass (TNG50-1 z=0.0) (r =  10 kpc)
# median
# cannot have nans, so nans replaced by -3
# M* [log Msun], v_cut=0,  v_cut=150, v_cut=250 (all [log km/])
Nelson19_00 = np.array([
(   7.50,   1.546,  -0.555,     -3.),
(   7.71,   1.476,  -0.161,     -3.),
(   7.91,   1.411,   0.060,     -3.),
(   8.12,   1.365,   0.207,     -3.),
(   8.33,   1.336,   0.287,     -3.),
(   8.53,   1.296,   0.361,  -0.186),
(   8.73,   1.246,   0.395,  -0.115),
(   8.95,   1.198,   0.417,  -0.053),
(   9.15,   1.162,   0.399,  -0.033),
(   9.36,   1.122,   0.398,  -0.018),
(   9.55,   1.079,   0.364,  -0.018),
(   9.77,   1.034,   0.300,  -0.059),
(   9.98,   1.036,   0.235,  -0.095),
(  10.19,   1.064,   0.216,  -0.168),
(  10.38,   1.103,   0.302,  -0.153),
(  10.59,   1.292,   0.643,   0.060),
(  10.79,   1.622,   1.120,   0.571),
(  11.01,   2.040,   1.652,   1.209),
(  11.20,   2.216,   1.944,   1.667),
(  11.59,   2.339,   2.196,   1.991),
(  11.96,   2.627,   2.579,   2.512)])

# Nelson+ (2019) http://arxiv.org/abs/1902.05554
# Figure 5 Mass Loading vs. Stellar Mass (TNG50-1 z=0.5) (r =  10 kpc)
# median
# M* [log Msun], v_cut=0, v_cut=150, v_cut=250 (all [log km/])
Nelson19_05 = np.array([
(   7.50,   1.670,   0.194,     -2.),
(   7.71,   1.606,   0.344,     -3.),
(   7.91,   1.549,   0.480,     -3.),
(   8.13,   1.492,   0.577,     -3.),
(   8.34,   1.441,   0.619,  -0.019),
(   8.54,   1.388,   0.646,   0.071),
(   8.76,   1.333,   0.655,   0.113),
(   8.96,   1.258,   0.650,   0.135),
(   9.17,   1.179,   0.626,   0.149),
(   9.38,   1.100,   0.593,   0.181),
(   9.60,   1.039,   0.538,   0.193),
(   9.80,   0.975,   0.470,   0.174),
(  10.03,   0.948,   0.412,   0.136),
(  10.22,   0.950,   0.412,   0.143),
(  10.42,   0.989,   0.442,   0.137),
(  10.63,   1.074,   0.581,   0.225),
(  10.84,   1.188,   0.765,   0.381),
(  11.04,   1.448,   1.152,   0.833),
(  11.26,   1.632,   1.426,   1.206),
(  11.46,   1.811,   1.681,   1.538),
(  11.65,   2.055,   1.956,   1.818)])

# Nelson+ (2019) http://arxiv.org/abs/1902.05554
# Figure 5 Mass Loading vs. Stellar Mass (TNG50-1 z=1.0) (r =  10 kpc)
# median
# M* [log Msun], v_cut=0, v_cut=150, v_cut=250 (all [log km/])
Nelson19_10 = np.array([
(   7.51,   1.697,   0.335,     -3.),
(   7.71,   1.635,   0.527,     -3.),
(   7.92,   1.571,   0.642,     -3.),
(   8.13,   1.505,   0.689,  -0.046),
(   8.34,   1.440,   0.715,   0.068),
(   8.55,   1.383,   0.741,   0.137),
(   8.76,   1.310,   0.758,   0.168),
(   8.97,   1.219,   0.743,   0.196),
(   9.18,   1.123,   0.713,   0.246),
(   9.41,   1.028,   0.658,   0.292),
(   9.61,   0.946,   0.596,   0.317),
(   9.82,   0.886,   0.524,   0.298),
(  10.03,   0.841,   0.466,   0.253),
(  10.25,   0.812,   0.417,   0.193),
(  10.45,   0.819,   0.406,   0.160),
(  10.65,   0.872,   0.465,   0.187),
(  10.88,   0.949,   0.621,   0.317),
(  11.09,   1.091,   0.851,   0.580),
(  11.25,   1.306,   1.147,   0.959),
(  11.53,   1.589,   1.531,   1.436)])

# Nelson+ (2019) http://arxiv.org/abs/1902.05554
# Figure 5 Mass Loading vs. Stellar Mass (TNG50-1 z=2.0) (r =  10 kpc)
# median
# M* [log Msun], v_cut=0,  v_cut=150, v_cut=250 (all [log km/])
Nelson19_20 = np.array([
(   7.50,   1.678,   0.756,  -0.525),
(   7.72,   1.597,   0.831,  -0.251),
(   7.93,   1.526,   0.874,  -0.062),
(   8.15,   1.461,   0.896,   0.088),
(   8.35,   1.393,   0.890,   0.203),
(   8.58,   1.326,   0.882,   0.246),
(   8.79,   1.250,   0.862,   0.266),
(   9.02,   1.160,   0.835,   0.331),
(   9.22,   1.056,   0.781,   0.409),
(   9.42,   0.950,   0.723,   0.459),
(   9.63,   0.846,   0.642,   0.436),
(   9.86,   0.743,   0.554,   0.387),
(  10.07,   0.661,   0.471,   0.315),
(  10.29,   0.574,   0.394,   0.248),
(  10.52,   0.527,   0.318,   0.156),
(  10.72,   0.486,   0.266,   0.085),
(  10.94,   0.652,   0.458,   0.265),
(  11.25,   0.968,   0.865,   0.714),
(  11.62,   1.359,   1.326,   1.272)])

# Nelson+ (2019) http://arxiv.org/abs/1902.05554
# Figure 5 Mass Loading vs. Stellar Mass (TNG50-1 z=4.0) (r =  10 kpc)
# median
# M* [log Msun], v_cut=0, v_cut=150, v_cut=250 (all [log km/])
Nelson19_40 = np.array([
(   7.49,   1.428,   0.972,   0.197),
(   7.71,   1.399,   0.986,   0.308),
(   7.92,   1.358,   0.982,   0.374),
(   8.13,   1.314,   0.972,   0.408),
(   8.35,   1.270,   0.958,   0.421),
(   8.56,   1.224,   0.944,   0.411),
(   8.77,   1.172,   0.929,   0.419),
(   8.97,   1.107,   0.906,   0.460),
(   9.20,   1.011,   0.849,   0.506),
(   9.40,   0.896,   0.771,   0.521),
(   9.63,   0.789,   0.695,   0.513),
(   9.82,   0.645,   0.573,   0.434),
(  10.09,   0.498,   0.434,   0.326),
(  10.28,   0.387,   0.307,   0.200),
(  10.49,   0.274,   0.173,   0.056),
(  10.94,  -0.050,  -0.120,  -0.211)])

Nelson19=[[Nelson19_00,Nelson19_05,Nelson19_10,Nelson19_20,Nelson19_40],np.array([0.0,0.5,1.0,2.0,4.0])]

fix = False
if(fix) : 
    # set massloading above 1e10 to be no higher than the value at 1e10 
    # has the effect of stopping the ridiculusly high outflowsat low z and high mass
    for (it, item) in enumerate(Nelson19[0]) : 
        mmm = 10.+Nelson19[1][it]/3.
        for ax in np.arange(3)+1: 
            immax = np.max(np.where(item[:,0]<mmm))
            item[immax:,ax] = np.minimum(item[immax:,ax],item[immax,ax])

'''
The following tables give the reaccretion/recycling times in Gyr for the three outflow components as seperate tables.
Each table has values for different redshifts (different lines) and different stellar masses (different columns), given in TNG100_zM.
To calculate these recycling times, we use the outflow velocity distribution from Nelson et al (2019, MNRAS 490 3234) to determine the median velocity of each component in each bin. 
The mean velocity for each bin is then used together with the baryon mass profile for each bin from the Illustris TNG100 simulation to determine 
the (friction-less) ballistic trajectory for each outflow component using a simple simulation and store the time untill the gas returns to the galaxy. 
'''

#TNG100_reaccretiontime_vel0 = np.array([
#(0.393,0.244,0.171,0.114,0.08,0.063,0.042),
#(0.46,0.279,0.185,0.126,0.086,0.066,0.05),
#(0.586,0.327,0.229,0.145,0.096,0.07,0.048),
#(0.756,0.37,0.265,0.168,0.105,0.066,0.043),
#(1.017,0.415,0.311,0.198,0.106,0.063,np.nan)])
#
#TNG100_reaccretiontime_vel150 = np.array([
#(np.nan,np.nan,2.373,0.691,0.238,0.125,0.062),
#(np.nan,np.nan,3.185,0.82,0.265,0.132,0.08),
#(np.nan,np.nan,4.299,0.947,0.338,0.138,0.07),
#(np.nan,np.nan,4.544,1.025,0.296,0.115,0.061),
#(np.nan,10.761,3.347,1.214,0.309,0.111, np.nan)])
#
#TNG100_reaccretiontime_vel300 = np.array([
#(np.nan,np.nan,np.nan,np.nan,np.nan,1.474,0.244),
#(np.nan,np.nan,np.nan,np.nan,np.nan,1.744,0.332),
#(np.nan,np.nan,np.nan,np.nan,np.nan,1.996,0.252),
#(np.nan,np.nan,np.nan,np.nan,np.nan,0.999,0.228),
#(np.nan,np.nan,np.nan,np.nan,np.nan,0.371,np.nan)])

TNG100_reaccretiontime_vel0 = np.array([
(0.6658,0.3979,0.2553,0.1584,0.1031,0.0581,0.0260),
(0.7921,0.4624,0.2704,0.1752,0.11,0.0567,0.0261),
(1.0006,0.5439,0.3552,0.2109,0.1199,0.0592,0.0242),
(1.3402,0.6306,0.4444,0.2629,0.1524,0.0789,0.0353),
(1.9748,0.9039,0.7958,0.4588,0.2060,0.1066,0.0353)])

TNG100_reaccretiontime_vel150 = np.array([
(np.nan,4.28,2.902,1.4929,0.7345,0.1512,0.0361),
(np.nan,5.336,3.552,1.8875,0.8809,0.1418,0.0373),
(np.nan,5.999,4.360,2.3600,1.3105,0.1441,0.0318),
(np.nan,6.996,5.694,3.0258,1.5289,0.2254,0.0538),
(np.nan,7.970,6.978,4.47,2.4269,0.4666, 0.0538)])

TNG100_reaccretiontime_vel300 = np.array([
(np.nan,np.nan,np.nan,np.nan,4.04,3.344,0.189),
(np.nan,np.nan,np.nan,np.nan,4.804,3.698,0.17),
(np.nan,np.nan,np.nan,np.nan,10.378,4.84,0.11),
(np.nan,np.nan,np.nan,np.nan,10.894,5.978,0.839),
(np.nan,np.nan,np.nan,np.nan,np.nan,4.286,0.839)])

TNG100_zM = [np.array([0.2,0.5,1.0,2.0,4.0]),([8.0, 9.0,9.5,10.0,10.5,11.0,11.5])]


# Functions to access the above tables

def find_mass_loading(mass,redshift):
    mass = np.maximum(1.,mass)
    zarray = Nelson19[1]
    nz = len(zarray)
    zidnext = np.maximum(1,np.minimum(nz-1,bisect.bisect(zarray,redshift)))
    zidprev = zidnext - 1

    fnext = np.maximum(0.,np.minimum(1.,(redshift - zarray[zidprev]) / (zarray[zidnext] - zarray[zidprev])))
    fprev = 1.-fnext   
    etas = np.zeros((2,3))
    for iz, zid in enumerate([zidprev, zidnext]): 
        table = Nelson19[0][zid]
        nm = len(table[:,0])
        mid = np.maximum(1,np.minimum(nm-1,bisect.bisect(table[:,0],np.log10(mass))))
        fhi = np.maximum(0.,np.minimum(1.,(np.log10(mass)-table[mid-1,0])/(table[mid,0]-table[mid-1,0] )))
        flo = 1-fhi
        etas[iz,:] = table[mid-1,1:4]*flo+ table[mid,1:4]*fhi
    eta = fprev*etas[0,:]+fnext*etas[1,:] 
    
#    print('in mass_loading {:6.2f} {:6.2f} {:} {:} {:} {:}'.format(redshift, np.log10(mass), zidprev,midprev,zidnext,mid))
#    print('in mass_loading {:} {:} {:} {:} {:} {:}'.format(eta_prev[0],eta_next[0],fprev,fnext,flo,fhi))
    return eta 
    
def find_reaccretion_time(mass,redshift):
    zarray = TNG100_zM[0]
    nz = len(zarray)
    zidnext = np.maximum(1,np.minimum(nz-1,bisect.bisect(zarray,redshift)))
    zidprev = zidnext - 1

    fnext = np.maximum(0.,np.minimum(1.,(redshift - zarray[zidprev]) / (zarray[zidnext] - zarray[zidprev])))
    fprev = 1.-fnext  
    
    marray = TNG100_zM[1]
    nm = len(marray)
    midhi = np.maximum(1,np.minimum(nm-1,bisect.bisect(marray,np.log10(mass))))
    midlo = midhi-1
    fhi = np.maximum(0.,np.minimum(1.,(np.log10(mass)-marray[midlo])/(marray[midhi]-marray[midlo])))
    flo = 1-fhi
    
    t_reacs = np.zeros(3)
    for ivel, table in enumerate([TNG100_reaccretiontime_vel0, TNG100_reaccretiontime_vel150, TNG100_reaccretiontime_vel300]):
         t_reacs[ivel] = (table[zidprev,midlo]*flo+table[zidprev,midhi]*fhi)*fprev + \
                         (table[zidnext,midlo]*flo+table[zidnext,midhi]*fhi)*fnext 


    return t_reacs

def find_yield(mass,metallicity,SNyields,AGByields,nisotopes,isotopes):
    if mass>=9:
        # Use SNyields
        mass_yields, mets, elements = yield_dict[SNyields]
        if isotopes!=elements:
            print("SN elements do not match up with lookup dictionary")
            stop
        metidx = (np.abs(np.log10(mets/metallicity))).argmin()
        idx = (np.abs(mass_yields[:,0]-mass)).argmin()
    else:
        # use AGByields
        mass_yields, mets, elements = yield_dict[AGByields]
        if isotopes!=elements:
            print("AGB elements do not match up with lookup dictionary")
            stop
        metidx = (np.abs(np.log10(mets/metallicity))).argmin()
        idx = (np.abs(mass_yields[:,0]-mass)).argmin()
    return mass_yields[idx][1+metidx+np.arange(nisotopes)*len(mets)]

def find_tot_yield(mass,metallicity,SNyields,AGByields,nisotopes,isotopes):
    if mass>=9:
        # Use SNyields
        mass_yields, mets, elements = yield_tot_dict[SNyields]
        if isotopes!=elements:
            print("SN elements do not match up with lookup dictionary")
            stop
        metidx = (np.abs(np.log10(mets/metallicity))).argmin()
        idx = (np.abs(mass_yields[:,0]-mass)).argmin()
    else:
        # use AGByields
        mass_yields, mets, elements = yield_tot_dict[AGByields]
        if isotopes!=elements:
            print("AGB elements do not match up with lookup dictionary")
            stop
        metidx = (np.abs(np.log10(mets/metallicity))).argmin()
        idx = (np.abs(mass_yields[:,0]-mass)).argmin()
    return mass_yields[idx][(1+metidx)::len(mets)]


def find_nearest(lookup,value):
    '''
    Take a 2D array and return pair of nearest neighbour values based on first column
    '''
    col1 = lookup[:,0]
    idx = (np.abs(col1-value)).argmin()
    return lookup[idx]

def find_nearest_col(lookup,value,colnum):
    '''
    Take a 2D array and return pair of nearest neighbour values based on first column
    '''
    col1 = lookup[:,0]
    idx = (np.abs(col1-value)).argmin()
    return lookup[idx][colnum]

def lookup_fn(lookup, column, value):
    '''
    return nearest neighbour value from function based on column input
    '''
    col1 = lookup[column]
    idx = (np.abs(col1-value)).argmin()
    return lookup[idx]

def lookup_taum(mass, colnum):
    '''
    Looks up nearest neighbour for lifetime of star of mass m from lifetime table
    reads in the relevant colnum for correct metallicity
    '''
    col1 = lifetime[:,0]
    idx = (np.abs(col1-mass)).argmin()
    return lifetime[idx][colnum]

